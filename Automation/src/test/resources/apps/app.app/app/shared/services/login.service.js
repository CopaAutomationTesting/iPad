"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var http_1 = require("@angular/http");
require("rxjs/add/operator/map");
require("rxjs/add/operator/catch");
require("rxjs/add/operator/catch");
var router_1 = require("nativescript-angular/router");
var handleError_extractData_service_1 = require("./handleError_extractData.service");
var app_constants_1 = require("../../app.constants");
var checkinorder_service_1 = require("./checkinorder.service");
var LoginService = /** @class */ (function () {
    function LoginService(routerExtensions, _http, _configuration, _shared) {
        this.routerExtensions = routerExtensions;
        this._http = _http;
        this._configuration = _configuration;
        this._shared = _shared;
        this.actionUrlforLogin = _configuration.ServerWithApiUrlForSiteminderLogin;
        this.startupTable = _configuration.HostPrinter;
        this.headerApiuser = _configuration.HeaderApiuser;
        this.headerCurrency = this._shared.GetCurrency();
        this.salesOffice = this._shared.GetUserPointofSale();
        this.actionUrlforProfile = _configuration.ServerWithApiUrlProfile;
        this.headers = new http_1.Headers();
        this.headers.append('Content-Type', 'application/json');
        this.headers.append('Accept', 'application/json');
        this.headerApiuser = _configuration.HeaderApiuser;
    }
    LoginService.prototype.login = function (username, Password) {
        var headers = new http_1.Headers();
        console.log("here");
        var requestData = "USER=" + username.toString() +
            "&PASSWORD=" + encodeURIComponent(Password.toString()) +
            "&TARGET=" + encodeURIComponent(this.actionUrlforProfile) +
            "&LOCATION=" + encodeURIComponent(this.actionUrlforProfile);
        headers.append('content-type', 'application/x-www-form-urlencoded');
        var option = new http_1.RequestOptions({ headers: headers, withCredentials: true });
        console.log(JSON.stringify(this.actionUrlforLogin));
        console.log(JSON.stringify(requestData));
        return this._http.post(this.actionUrlforLogin + 'siteminderagent/forms/login.fcc', requestData, option).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    LoginService.prototype.StatupTable = function () {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        return this._http.get(this.startupTable + "reference/startup", { headers: headers })
            .map(handleError_extractData_service_1.HandleErrorExtractData.extractData)
            .catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    LoginService = __decorate([
        core_1.Injectable(),
        __metadata("design:paramtypes", [router_1.RouterExtensions, http_1.Http, app_constants_1.Configuration, checkinorder_service_1.CheckinOrderService])
    ], LoginService);
    return LoginService;
}());
exports.LoginService = LoginService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9naW4uc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImxvZ2luLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxzQ0FBMkM7QUFDM0Msc0NBQXdFO0FBRXhFLGlDQUErQjtBQUMvQixtQ0FBaUM7QUFDakMsbUNBQWlDO0FBRWpDLHNEQUErRDtBQUcvRCxxRkFBMkU7QUFDM0UscURBQW9EO0FBQ3BELCtEQUE2RDtBQUk3RDtJQVdJLHNCQUFvQixnQkFBa0MsRUFBVSxLQUFXLEVBQVUsY0FBNkIsRUFBVSxPQUE0QjtRQUFwSSxxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWtCO1FBQVUsVUFBSyxHQUFMLEtBQUssQ0FBTTtRQUFVLG1CQUFjLEdBQWQsY0FBYyxDQUFlO1FBQVUsWUFBTyxHQUFQLE9BQU8sQ0FBcUI7UUFDcEosSUFBSSxDQUFDLGlCQUFpQixHQUFHLGNBQWMsQ0FBQyxrQ0FBa0MsQ0FBQztRQUMzRSxJQUFJLENBQUMsWUFBWSxHQUFHLGNBQWMsQ0FBQyxXQUFXLENBQUM7UUFDL0MsSUFBSSxDQUFDLGFBQWEsR0FBRyxjQUFjLENBQUMsYUFBYSxDQUFDO1FBQ2xELElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNqRCxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztRQUNyRCxJQUFJLENBQUMsbUJBQW1CLEdBQUcsY0FBYyxDQUFDLHVCQUF1QixDQUFDO1FBQ2xFLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxjQUFPLEVBQUUsQ0FBQztRQUM3QixJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxjQUFjLEVBQUUsa0JBQWtCLENBQUMsQ0FBQztRQUN4RCxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsa0JBQWtCLENBQUMsQ0FBQztRQUNsRCxJQUFJLENBQUMsYUFBYSxHQUFHLGNBQWMsQ0FBQyxhQUFhLENBQUM7SUFHdEQsQ0FBQztJQUNNLDRCQUFLLEdBQVosVUFBYSxRQUFhLEVBQUUsUUFBYTtRQUNyQyxJQUFJLE9BQU8sR0FBRyxJQUFJLGNBQU8sRUFBRSxDQUFDO1FBQzVCLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDcEIsSUFBSSxXQUFXLEdBQ1gsT0FBTyxHQUFHLFFBQVEsQ0FBQyxRQUFRLEVBQUU7WUFDN0IsWUFBWSxHQUFHLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUN0RCxVQUFVLEdBQUcsa0JBQWtCLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDO1lBQ3pELFlBQVksR0FBRyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsbUJBQW1CLENBQUMsQ0FBQztRQUNoRSxPQUFPLENBQUMsTUFBTSxDQUFDLGNBQWMsRUFBRSxtQ0FBbUMsQ0FBQyxDQUFDO1FBQ3BFLElBQUksTUFBTSxHQUFHLElBQUkscUJBQWMsQ0FBQyxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsZUFBZSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUE7UUFDNUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUM7UUFDcEQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7UUFDekMsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLEdBQUcsaUNBQWlDLEVBQUUsV0FBVyxFQUFFLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyx3REFBc0IsQ0FBQyxXQUFXLENBQUMsQ0FBQyxLQUFLLENBQUMsd0RBQXNCLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDL0wsQ0FBQztJQUNNLGtDQUFXLEdBQWxCO1FBRVEsSUFBSSxPQUFPLEdBQUcsSUFBSSxjQUFPLEVBQUUsQ0FBQztRQUM1QixPQUFPLENBQUMsTUFBTSxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDMUMsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsWUFBWSxHQUFDLG1CQUFtQixFQUFFLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxDQUFDO2FBQzdFLEdBQUcsQ0FBQyx3REFBc0IsQ0FBQyxXQUFXLENBQUM7YUFDdkMsS0FBSyxDQUFDLHdEQUFzQixDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQ3BELENBQUM7SUE5Q0EsWUFBWTtRQUZ4QixpQkFBVSxFQUFFO3lDQWE2Qix5QkFBZ0IsRUFBaUIsV0FBSSxFQUEwQiw2QkFBYSxFQUFtQiwwQ0FBbUI7T0FYL0ksWUFBWSxDQStDeEI7SUFBRCxtQkFBQztDQUFBLEFBL0NELElBK0NDO0FBL0NZLG9DQUFZIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSHR0cCwgUmVzcG9uc2UsIEhlYWRlcnMsIFJlcXVlc3RPcHRpb25zIH0gZnJvbSAnQGFuZ3VsYXIvaHR0cCc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcy9SeCc7XG5pbXBvcnQgJ3J4anMvYWRkL29wZXJhdG9yL21hcCc7XG5pbXBvcnQgJ3J4anMvYWRkL29wZXJhdG9yL2NhdGNoJztcbmltcG9ydCAncnhqcy9hZGQvb3BlcmF0b3IvY2F0Y2gnO1xuaW1wb3J0ICogYXMgZGlhbG9ncyBmcm9tIFwidWkvZGlhbG9nc1wiO1xuaW1wb3J0IHsgUm91dGVyRXh0ZW5zaW9ucyB9IGZyb20gXCJuYXRpdmVzY3JpcHQtYW5ndWxhci9yb3V0ZXJcIjtcbmltcG9ydCB7IFJvdXRlciwgTmF2aWdhdGlvbkV4dHJhcywgQWN0aXZhdGVkUm91dGUgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuaW1wb3J0ICogYXMgQXBwbGljYXRpb25TZXR0aW5ncyBmcm9tIFwiYXBwbGljYXRpb24tc2V0dGluZ3NcIjtcbmltcG9ydCB7IEhhbmRsZUVycm9yRXh0cmFjdERhdGEgfSBmcm9tIFwiLi9oYW5kbGVFcnJvcl9leHRyYWN0RGF0YS5zZXJ2aWNlXCI7XG5pbXBvcnQgeyBDb25maWd1cmF0aW9uIH0gZnJvbSAnLi4vLi4vYXBwLmNvbnN0YW50cyc7XG5pbXBvcnQgeyBDaGVja2luT3JkZXJTZXJ2aWNlIH0gZnJvbSBcIi4vY2hlY2tpbm9yZGVyLnNlcnZpY2VcIjtcblxuQEluamVjdGFibGUoKVxuXG5leHBvcnQgY2xhc3MgTG9naW5TZXJ2aWNlIHtcbiAgICBcbiAgICBwcml2YXRlIGFjdGlvblVybGZvclByb2ZpbGU6IHN0cmluZztcbiAgICBwcml2YXRlIGFjdGlvblVybHdpdGhBUEkgOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBzYWxlc09mZmljZTogc3RyaW5nO1xuICAgIHByaXZhdGUgaGVhZGVyczogSGVhZGVycztcbiAgICBwcml2YXRlIGhlYWRlckN1cnJlbmN5OiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBhY3Rpb25Vcmxmb3JMb2dpbjogc3RyaW5nO1xuICAgIHByaXZhdGUgaGVhZGVyQXBpdXNlcjogc3RyaW5nO1xuICAgIHB1YmxpYyAgc3RhcnR1cFRhYmxlOnN0cmluZztcbiAgICBcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJvdXRlckV4dGVuc2lvbnM6IFJvdXRlckV4dGVuc2lvbnMsIHByaXZhdGUgX2h0dHA6IEh0dHAsIHByaXZhdGUgX2NvbmZpZ3VyYXRpb246IENvbmZpZ3VyYXRpb24sIHByaXZhdGUgX3NoYXJlZDogQ2hlY2tpbk9yZGVyU2VydmljZSkge1xuICAgICAgICB0aGlzLmFjdGlvblVybGZvckxvZ2luID0gX2NvbmZpZ3VyYXRpb24uU2VydmVyV2l0aEFwaVVybEZvclNpdGVtaW5kZXJMb2dpbjtcbiAgICAgICAgdGhpcy5zdGFydHVwVGFibGUgPSBfY29uZmlndXJhdGlvbi5Ib3N0UHJpbnRlcjtcbiAgICAgICAgdGhpcy5oZWFkZXJBcGl1c2VyID0gX2NvbmZpZ3VyYXRpb24uSGVhZGVyQXBpdXNlcjtcbiAgICAgICAgdGhpcy5oZWFkZXJDdXJyZW5jeSA9IHRoaXMuX3NoYXJlZC5HZXRDdXJyZW5jeSgpO1xuICAgICAgICB0aGlzLnNhbGVzT2ZmaWNlID0gdGhpcy5fc2hhcmVkLkdldFVzZXJQb2ludG9mU2FsZSgpO1xuICAgICAgICB0aGlzLmFjdGlvblVybGZvclByb2ZpbGUgPSBfY29uZmlndXJhdGlvbi5TZXJ2ZXJXaXRoQXBpVXJsUHJvZmlsZTtcbiAgICAgICAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgICAgdGhpcy5oZWFkZXJzLmFwcGVuZCgnQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcbiAgICAgICAgdGhpcy5oZWFkZXJzLmFwcGVuZCgnQWNjZXB0JywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcbiAgICAgICAgdGhpcy5oZWFkZXJBcGl1c2VyID0gX2NvbmZpZ3VyYXRpb24uSGVhZGVyQXBpdXNlcjtcblxuICAgICAgICBcbiAgICB9XG4gICAgcHVibGljIGxvZ2luKHVzZXJuYW1lOiBhbnksIFBhc3N3b3JkOiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiaGVyZVwiKTtcbiAgICAgICAgbGV0IHJlcXVlc3REYXRhID1cbiAgICAgICAgICAgIFwiVVNFUj1cIiArIHVzZXJuYW1lLnRvU3RyaW5nKCkgK1xuICAgICAgICAgICAgXCImUEFTU1dPUkQ9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoUGFzc3dvcmQudG9TdHJpbmcoKSkgK1xuICAgICAgICAgICAgXCImVEFSR0VUPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuYWN0aW9uVXJsZm9yUHJvZmlsZSkgK1xuICAgICAgICAgICAgXCImTE9DQVRJT049XCIgKyBlbmNvZGVVUklDb21wb25lbnQodGhpcy5hY3Rpb25Vcmxmb3JQcm9maWxlKTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKTtcbiAgICAgICAgbGV0IG9wdGlvbiA9IG5ldyBSZXF1ZXN0T3B0aW9ucyh7IGhlYWRlcnM6IGhlYWRlcnMsIHdpdGhDcmVkZW50aWFsczogdHJ1ZSB9KVxuICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeSh0aGlzLmFjdGlvblVybGZvckxvZ2luKSk7XG4gICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHJlcXVlc3REYXRhKSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9odHRwLnBvc3QodGhpcy5hY3Rpb25Vcmxmb3JMb2dpbiArICdzaXRlbWluZGVyYWdlbnQvZm9ybXMvbG9naW4uZmNjJywgcmVxdWVzdERhdGEsIG9wdGlvbikubWFwKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuZXh0cmFjdERhdGEpLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcbiAgICB9XG4gICAgcHVibGljIFN0YXR1cFRhYmxlKCk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIFxuICAgICAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuICAgICAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJBcGlVc2VyXCIsIHRoaXMuaGVhZGVyQXBpdXNlcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAuZ2V0KHRoaXMuc3RhcnR1cFRhYmxlK1wicmVmZXJlbmNlL3N0YXJ0dXBcIiwgeyBoZWFkZXJzOiBoZWFkZXJzIH0pXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSlcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcbiAgICAgICAgICAgIH1cbn0iXX0=