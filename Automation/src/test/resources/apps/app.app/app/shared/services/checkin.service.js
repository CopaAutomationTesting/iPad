"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
//angular & nativescript references
var core_1 = require("@angular/core");
var http_1 = require("@angular/http");
require("rxjs/add/operator/map");
require("rxjs/add/operator/catch");
var app_constants_1 = require("../../app.constants");
var checkinorder_service_1 = require("./checkinorder.service");
var handleError_extractData_service_1 = require("./handleError_extractData.service");
var CheckinService = /** @class */ (function () {
    function CheckinService(_http, _configuration, _shared) {
        this._http = _http;
        this._configuration = _configuration;
        this._shared = _shared;
        var config = _configuration;
        this.actionUrl = config.ServerWithApiUrlCheckin;
        this.headerApiuser = config.HeaderApiuser;
        this.headerCurrency = this._shared.GetCurrency();
        this.salesOffice = this._shared.GetUserPointofSale();
        this.headers = new http_1.Headers();
        this.headers.append('Content-Type', 'application/json');
        this.headers.append('Accept', 'application/json');
        this.actionUrlforOffload = _configuration.ServerWithApiUrlOffload;
        this.actionURLDRS = _configuration.CompensationType;
        this.actionUrlforCheckIn = _configuration.checkin;
        this.actionUrlforbookingcount = _configuration.ServerWithApiUrlbookingcount;
        this.actionUrlforPaxByFlight = _configuration.ServerWithApiUrlFlights;
    }
    CheckinService.prototype.PostCheckin = function (model) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.post(this.actionUrl, JSON.stringify(model), { headers: headers })
            .map(handleError_extractData_service_1.HandleErrorExtractData.extractData)
            .catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    CheckinService.prototype.Offload = function (request) {
        var headers = new http_1.Headers();
        console.log(JSON.stringify(request));
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.post(this.actionUrlforOffload, JSON.stringify(request), { headers: headers })
            .map(handleError_extractData_service_1.HandleErrorExtractData.extractData)
            .catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    CheckinService.prototype.CheckInPax = function (request) {
        var headers = new http_1.Headers();
        console.log(JSON.stringify(request));
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.post(this.actionUrlforCheckIn, JSON.stringify(request), { headers: headers })
            .map(handleError_extractData_service_1.HandleErrorExtractData.extractData)
            .catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
        // return this._http.post("http://ustlssoat258.airservices.svcs.entsvcs.net:12499/api/checkin", JSON.stringify(request), { headers: headers })
        // .map(HandleErrorExtractData.extractData)
        // .catch(HandleErrorExtractData.handleErrors);
    };
    CheckinService.prototype.CheckInPaxWithFqtv = function (request) {
        var headers = new http_1.Headers();
        console.log(JSON.stringify(request));
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.post(this.actionUrlforCheckIn + "?updateFQTV=true", JSON.stringify(request), { headers: headers })
            .map(handleError_extractData_service_1.HandleErrorExtractData.extractData)
            .catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    CheckinService.prototype.DrsPage = function (Category, Subject, Page) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        if (Category != "" && Subject != "" && Page != "") {
            return this._http.get(this.actionURLDRS + "reference/agenthelp?catg=" + Category + "&page=" + Page + "&subj=" + Subject, { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
        }
        else if (Category != "" && Subject != "") {
            return this._http.get(this.actionURLDRS + "reference/agenthelp?catg=" + Category + "&subj=" + Subject, { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
        }
        else if (Category != "") {
            return this._http.get(this.actionURLDRS + "reference/agenthelp?catg=" + Category, { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
        }
        else {
            return this._http.get(this.actionURLDRS + "reference/agenthelp", { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
        }
    };
    CheckinService.prototype.Inventory = function (date, flightnumber) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.get(this.actionUrlforPaxByFlight + date + "/" + flightnumber + "/inventory", { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    CheckinService.prototype.InBound = function (date, flightnumber, city) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.get(this.actionUrlforPaxByFlight + date + "/" + flightnumber + "/" + city + "/inbound", { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    CheckinService.prototype.OutBound = function (date, flightnumber, city) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.get(this.actionUrlforPaxByFlight + date + "/" + flightnumber + "/" + city + "/outbound", { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    CheckinService.prototype.BookingCountDisplay = function (date, flightnumber, origin) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.get(this.actionUrlforbookingcount + date + "/" + flightnumber + "/" + origin + "/" + "bookingcount", { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    CheckinService = __decorate([
        core_1.Injectable(),
        __metadata("design:paramtypes", [http_1.Http, app_constants_1.Configuration, checkinorder_service_1.CheckinOrderService])
    ], CheckinService);
    return CheckinService;
}());
exports.CheckinService = CheckinService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hlY2tpbi5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2hlY2tpbi5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsbUNBQW1DO0FBQ25DLHNDQUEyQztBQUMzQyxzQ0FBd0Q7QUFFeEQsaUNBQStCO0FBQy9CLG1DQUFpQztBQUlqQyxxREFBb0Q7QUFFcEQsK0RBQThEO0FBQzlELHFGQUE0RTtBQUc1RTtJQWFJLHdCQUFvQixLQUFXLEVBQVUsY0FBNkIsRUFBUyxPQUEyQjtRQUF0RixVQUFLLEdBQUwsS0FBSyxDQUFNO1FBQVUsbUJBQWMsR0FBZCxjQUFjLENBQWU7UUFBUyxZQUFPLEdBQVAsT0FBTyxDQUFvQjtRQUV0RyxJQUFJLE1BQU0sR0FBRyxjQUFjLENBQUM7UUFDNUIsSUFBSSxDQUFDLFNBQVMsR0FBRyxNQUFNLENBQUMsdUJBQXVCLENBQUM7UUFDaEQsSUFBSSxDQUFDLGFBQWEsR0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDO1FBQ3hDLElBQUksQ0FBQyxjQUFjLEdBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNoRCxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztRQUNyRCxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksY0FBTyxFQUFFLENBQUM7UUFDN0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLGtCQUFrQixDQUFDLENBQUM7UUFDeEQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLGtCQUFrQixDQUFDLENBQUM7UUFDbEQsSUFBSSxDQUFDLG1CQUFtQixHQUFHLGNBQWMsQ0FBQyx1QkFBdUIsQ0FBQztRQUNsRSxJQUFJLENBQUMsWUFBWSxHQUFDLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQztRQUNsRCxJQUFJLENBQUMsbUJBQW1CLEdBQUcsY0FBYyxDQUFDLE9B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LElBQUksR0FBRyxHQUFHLEdBQUcsWUFBWSxHQUFHLEdBQUcsR0FBRyxNQUFNLEdBQUcsR0FBRyxHQUFHLGNBQWMsRUFBRSxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyx3REFBc0IsQ0FBQyxXQUFXLENBQUMsQ0FBQyxLQUFLLENBQUMsd0RBQXNCLENBQUMsWUFBWSxDQUFDLENBQUM7SUFFcE8sQ0FBQztJQS9JTyxjQUFjO1FBRHpCLGlCQUFVLEVBQUU7eUNBY2lCLFdBQUksRUFBMEIsNkJBQWEsRUFBaUIsMENBQW1CO09BYmpHLGNBQWMsQ0FtSjFCO0lBQUQscUJBQUM7Q0FBQSxBQW5KRCxJQW1KQztBQW5KWSx3Q0FBYyIsInNvdXJjZXNDb250ZW50IjpbIi8vYW5ndWxhciAmIG5hdGl2ZXNjcmlwdCByZWZlcmVuY2VzXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBIdHRwLCBSZXNwb25zZSwgSGVhZGVycyB9IGZyb20gJ0Bhbmd1bGFyL2h0dHAnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMvUngnO1xuaW1wb3J0ICdyeGpzL2FkZC9vcGVyYXRvci9tYXAnO1xuaW1wb3J0ICdyeGpzL2FkZC9vcGVyYXRvci9jYXRjaCc7XG5cbi8vYXBwIHJlZmVyZW5jZXNcbmltcG9ydCB7IFBhc3NlbmdlciB9IGZyb20gJy4uL2ludGVyZmFjZS9pbmRleCc7XG5pbXBvcnQgeyBDb25maWd1cmF0aW9uIH0gZnJvbSAnLi4vLi4vYXBwLmNvbnN0YW50cyc7XG5pbXBvcnQgeyBBcHBFeGVjdXRpb250aW1lIH0gZnJvbSBcIi4uLy4uL2FwcC5leGVjdXRpb250aW1lXCI7XG5pbXBvcnQgeyAgQ2hlY2tpbk9yZGVyU2VydmljZSB9IGZyb20gXCIuL2NoZWNraW5vcmRlci5zZXJ2aWNlXCI7XG5pbXBvcnQgeyAgSGFuZGxlRXJyb3JFeHRyYWN0RGF0YSB9IGZyb20gXCIuL2hhbmRsZUVycm9yX2V4dHJhY3REYXRhLnNlcnZpY2VcIjtcblxuIEBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBDaGVja2luU2VydmljZSB7XG4gXG4gICAgcHJpdmF0ZSBhY3Rpb25Vcmw6IHN0cmluZztcbiAgICBwcml2YXRlIGhlYWRlcnM6IEhlYWRlcnM7XG4gICAgcHJpdmF0ZSBoZWFkZXJBcGl1c2VyOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBoZWFkZXJDdXJyZW5jeTpzdHJpbmdcbiAgICBwcml2YXRlIHNhbGVzT2ZmaWNlOnN0cmluZztcbiAgICBwcml2YXRlIGFjdGlvblVybGZvckNoZWNrSW46IHN0cmluZztcbiAgICBwcml2YXRlIGFjdGlvblVybGZvck9mZmxvYWQ6IHN0cmluZztcbiAgICBwcml2YXRlIGFjdGlvblVSTERSUzpzdHJpbmc7XG4gICAgcHJpdmF0ZSBhY3Rpb25Vcmxmb3Jib29raW5nY291bnQ6IHN0cmluZztcbiAgICBwcml2YXRlIGFjdGlvblVybGZvclBheEJ5RmxpZ2h0OiBzdHJpbmc7XG4gICAgXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBfaHR0cDogSHR0cCwgcHJpdmF0ZSBfY29uZmlndXJhdGlvbjogQ29uZmlndXJhdGlvbixwcml2YXRlIF9zaGFyZWQ6Q2hlY2tpbk9yZGVyU2VydmljZSkge1xuIFxuICAgICAgICB2YXIgY29uZmlnID0gX2NvbmZpZ3VyYXRpb247XG4gICAgICAgIHRoaXMuYWN0aW9uVXJsID0gY29uZmlnLlNlcnZlcldpdGhBcGlVcmxDaGVja2luO1xuICAgICAgICB0aGlzLmhlYWRlckFwaXVzZXI9Y29uZmlnLkhlYWRlckFwaXVzZXI7XG4gICAgICAgIHRoaXMuaGVhZGVyQ3VycmVuY3kgPXRoaXMuX3NoYXJlZC5HZXRDdXJyZW5jeSgpO1xuICAgICAgICB0aGlzLnNhbGVzT2ZmaWNlID0gdGhpcy5fc2hhcmVkLkdldFVzZXJQb2ludG9mU2FsZSgpOyAgICAgICAgXG4gICAgICAgIHRoaXMuaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICAgIHRoaXMuaGVhZGVycy5hcHBlbmQoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgICAgIHRoaXMuaGVhZGVycy5hcHBlbmQoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgICAgIHRoaXMuYWN0aW9uVXJsZm9yT2ZmbG9hZCA9IF9jb25maWd1cmF0aW9uLlNlcnZlcldpdGhBcGlVcmxPZmZsb2FkO1xuICAgICAgICB0aGlzLmFjdGlvblVSTERSUz1fY29uZmlndXJhdGlvbi5Db21wZW5zYXRpb25UeXBlO1xuICAgICAgICB0aGlzLmFjdGlvblVybGZvckNoZWNrSW4gPSBfY29uZmlndXJhdGlvbi5jaGVja2luO1xuICAgICAgICB0aGlzLmFjdGlvblVybGZvcmJvb2tpbmdjb3VudCA9IF9jb25maWd1cmF0aW9uLlNlcnZlcldpdGhBcGlVcmxib29raW5nY291bnQ7XG4gICAgICAgIHRoaXMuYWN0aW9uVXJsZm9yUGF4QnlGbGlnaHQgPSBfY29uZmlndXJhdGlvbi5TZXJ2ZXJXaXRoQXBpVXJsRmxpZ2h0cztcbiAgICAgICAgXG4gICAgICAgIFxuICAgIH1cblxuICAgIHB1YmxpYyBQb3N0Q2hlY2tpbiAobW9kZWwpIHtcbiAgICAgICBcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcIkFwaVVzZXJcIiwgdGhpcy5oZWFkZXJBcGl1c2VyKTsgICBcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX2N1cnJlbmN5XCIsdGhpcy5oZWFkZXJDdXJyZW5jeSk7ICBcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX3NhbGVzb2ZmaWNlXCIsdGhpcy5zYWxlc09mZmljZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9odHRwLnBvc3QodGhpcy5hY3Rpb25VcmwsSlNPTi5zdHJpbmdpZnkobW9kZWwpLFxuICAgICAgICB7IGhlYWRlcnM6IGhlYWRlcnMgfVxuICAgICAgICApXG4gICAgICAgIC5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSlcbiAgICAgICAgLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcbiAgICB9IFxuICAgIHB1YmxpYyBPZmZsb2FkKHJlcXVlc3Q6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIFxuICAgICAgICBcbiAgICAgICAgICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkocmVxdWVzdCkpO1xuICAgICAgICAgICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiQXBpVXNlclwiLCB0aGlzLmhlYWRlckFwaXVzZXIpO1xuICAgICAgICAgICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiaHR0cF9jdXJyZW5jeVwiLCB0aGlzLmhlYWRlckN1cnJlbmN5KTtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfc2FsZXNvZmZpY2VcIiwgdGhpcy5zYWxlc09mZmljZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAucG9zdCh0aGlzLmFjdGlvblVybGZvck9mZmxvYWQsIEpTT04uc3RyaW5naWZ5KHJlcXVlc3QpLCB7IGhlYWRlcnM6IGhlYWRlcnMgfSlcbiAgICAgICAgICAgICAgICAgICAgLm1hcChIYW5kbGVFcnJvckV4dHJhY3REYXRhLmV4dHJhY3REYXRhKVxuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcbiAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgIHB1YmxpYyBDaGVja0luUGF4KHJlcXVlc3Q6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XG5cblxuICAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkocmVxdWVzdCkpO1xuICAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJBcGlVc2VyXCIsIHRoaXMuaGVhZGVyQXBpdXNlcik7XG4gICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfY3VycmVuY3lcIiwgdGhpcy5oZWFkZXJDdXJyZW5jeSk7XG4gICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfc2FsZXNvZmZpY2VcIiwgdGhpcy5zYWxlc09mZmljZSk7XG4gICAgICAgICByZXR1cm4gdGhpcy5faHR0cC5wb3N0KHRoaXMuYWN0aW9uVXJsZm9yQ2hlY2tJbiwgSlNPTi5zdHJpbmdpZnkocmVxdWVzdCksIHsgaGVhZGVyczogaGVhZGVycyB9KVxuICAgICAgICAgICAgIC5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSlcblxuICAgICAgICAgICAgIC5jYXRjaChIYW5kbGVFcnJvckV4dHJhY3REYXRhLmhhbmRsZUVycm9ycyk7XG4gICAgICAgICAvLyByZXR1cm4gdGhpcy5faHR0cC5wb3N0KFwiaHR0cDovL3VzdGxzc29hdDI1OC5haXJzZXJ2aWNlcy5zdmNzLmVudHN2Y3MubmV0OjEyNDk5L2FwaS9jaGVja2luXCIsIEpTT04uc3RyaW5naWZ5KHJlcXVlc3QpLCB7IGhlYWRlcnM6IGhlYWRlcnMgfSlcbiAgICAgICAgIC8vIC5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSlcblxuICAgICAgICAgLy8gLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcbiAgICAgfVxuXG4gICAgIHB1YmxpYyBDaGVja0luUGF4V2l0aEZxdHYgKHJlcXVlc3Q6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkocmVxdWVzdCkpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcIkFwaVVzZXJcIiwgdGhpcy5oZWFkZXJBcGl1c2VyKTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX2N1cnJlbmN5XCIsIHRoaXMuaGVhZGVyQ3VycmVuY3kpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfc2FsZXNvZmZpY2VcIiwgdGhpcy5zYWxlc09mZmljZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9odHRwLnBvc3QodGhpcy5hY3Rpb25Vcmxmb3JDaGVja0luK1wiP3VwZGF0ZUZRVFY9dHJ1ZVwiLCBKU09OLnN0cmluZ2lmeShyZXF1ZXN0KSwgeyBoZWFkZXJzOiBoZWFkZXJzIH0pXG4gICAgICAgICAgICAubWFwKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuZXh0cmFjdERhdGEpXG5cbiAgICAgICAgICAgIC5jYXRjaChIYW5kbGVFcnJvckV4dHJhY3REYXRhLmhhbmRsZUVycm9ycyk7XG4gICAgfVxuXG4gICAgIHB1YmxpYyBEcnNQYWdlKENhdGVnb3J5OiBzdHJpbmcsIFN1YmplY3Q6IHN0cmluZywgUGFnZTogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcIkFwaVVzZXJcIiwgdGhpcy5oZWFkZXJBcGl1c2VyKTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX2N1cnJlbmN5XCIsIHRoaXMuaGVhZGVyQ3VycmVuY3kpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfc2FsZXNvZmZpY2VcIiwgdGhpcy5zYWxlc09mZmljZSk7XG4gICAgICAgICBpZiAoQ2F0ZWdvcnkgIT0gXCJcIiAmJiBTdWJqZWN0ICE9IFwiXCIgJiYgUGFnZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAuZ2V0KHRoaXMuYWN0aW9uVVJMRFJTICsgXCJyZWZlcmVuY2UvYWdlbnRoZWxwP2NhdGc9XCIgKyBDYXRlZ29yeSArIFwiJnBhZ2U9XCIgKyBQYWdlICsgXCImc3Viaj1cIiArIFN1YmplY3QsIHsgaGVhZGVyczogaGVhZGVycyB9KS5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSkuY2F0Y2goSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5oYW5kbGVFcnJvcnMpO1xuICAgICAgICAgfSBlbHNlIGlmIChDYXRlZ29yeSAhPSBcIlwiICYmIFN1YmplY3QgIT0gXCJcIikge1xuICAgICAgICAgICAgIHJldHVybiB0aGlzLl9odHRwLmdldCh0aGlzLmFjdGlvblVSTERSUyArIFwicmVmZXJlbmNlL2FnZW50aGVscD9jYXRnPVwiICsgQ2F0ZWdvcnkgKyBcIiZzdWJqPVwiICsgU3ViamVjdCwgeyBoZWFkZXJzOiBoZWFkZXJzIH0pLm1hcChIYW5kbGVFcnJvckV4dHJhY3REYXRhLmV4dHJhY3REYXRhKS5jYXRjaChIYW5kbGVFcnJvckV4dHJhY3REYXRhLmhhbmRsZUVycm9ycyk7XG4gICAgICAgICB9IGVsc2UgaWYgKENhdGVnb3J5ICE9IFwiXCIpIHtcbiAgICAgICAgICAgICByZXR1cm4gdGhpcy5faHR0cC5nZXQodGhpcy5hY3Rpb25VUkxEUlMgKyBcInJlZmVyZW5jZS9hZ2VudGhlbHA/Y2F0Zz1cIiArIENhdGVnb3J5LCB7IGhlYWRlcnM6IGhlYWRlcnMgfSkubWFwKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuZXh0cmFjdERhdGEpLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcbiAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAuZ2V0KHRoaXMuYWN0aW9uVVJMRFJTICsgXCJyZWZlcmVuY2UvYWdlbnRoZWxwXCIsIHsgaGVhZGVyczogaGVhZGVycyB9KS5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSkuY2F0Y2goSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5oYW5kbGVFcnJvcnMpO1xuXG4gICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIEludmVudG9yeShkYXRlOiBzdHJpbmcsIGZsaWdodG51bWJlcjogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICAgICAgXG4gICAgICAgIFxuICAgICAgICAgICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLmFwcGVuZChcIkFwaVVzZXJcIiwgdGhpcy5oZWFkZXJBcGl1c2VyKTtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfY3VycmVuY3lcIiwgdGhpcy5oZWFkZXJDdXJyZW5jeSk7XG4gICAgICAgICAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX3NhbGVzb2ZmaWNlXCIsIHRoaXMuc2FsZXNPZmZpY2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9odHRwLmdldCh0aGlzLmFjdGlvblVybGZvclBheEJ5RmxpZ2h0ICsgZGF0ZSArIFwiL1wiICsgZmxpZ2h0bnVtYmVyICsgXCIvaW52ZW50b3J5XCIsIHsgaGVhZGVyczogaGVhZGVycyB9KS5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSkuY2F0Y2goSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5oYW5kbGVFcnJvcnMpO1xuICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgcHVibGljIEluQm91bmQoZGF0ZTogc3RyaW5nLCBmbGlnaHRudW1iZXI6IHN0cmluZywgY2l0eTogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcblxuXG4gICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICAgICBoZWFkZXJzLmFwcGVuZChcIkFwaVVzZXJcIiwgdGhpcy5oZWFkZXJBcGl1c2VyKTtcbiAgICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiaHR0cF9jdXJyZW5jeVwiLCB0aGlzLmhlYWRlckN1cnJlbmN5KTtcbiAgICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiaHR0cF9zYWxlc29mZmljZVwiLCB0aGlzLnNhbGVzT2ZmaWNlKTtcbiAgICAgICAgIHJldHVybiB0aGlzLl9odHRwLmdldCh0aGlzLmFjdGlvblVybGZvclBheEJ5RmxpZ2h0ICsgZGF0ZSArIFwiL1wiICsgZmxpZ2h0bnVtYmVyICsgXCIvXCIgKyBjaXR5ICsgXCIvaW5ib3VuZFwiLCB7IGhlYWRlcnM6IGhlYWRlcnMgfSkubWFwKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuZXh0cmFjdERhdGEpLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcblxuICAgICB9XG4gICAgIHB1YmxpYyBPdXRCb3VuZChkYXRlOiBzdHJpbmcsIGZsaWdodG51bWJlcjogc3RyaW5nLCBjaXR5OiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xuXG5cbiAgICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiQXBpVXNlclwiLCB0aGlzLmhlYWRlckFwaXVzZXIpO1xuICAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX2N1cnJlbmN5XCIsIHRoaXMuaGVhZGVyQ3VycmVuY3kpO1xuICAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX3NhbGVzb2ZmaWNlXCIsIHRoaXMuc2FsZXNPZmZpY2UpO1xuICAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAuZ2V0KHRoaXMuYWN0aW9uVXJsZm9yUGF4QnlGbGlnaHQgKyBkYXRlICsgXCIvXCIgKyBmbGlnaHRudW1iZXIgKyBcIi9cIiArIGNpdHkgKyBcIi9vdXRib3VuZFwiLCB7IGhlYWRlcnM6IGhlYWRlcnMgfSkubWFwKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuZXh0cmFjdERhdGEpLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcblxuICAgICB9XG4gICAgIHB1YmxpYyBCb29raW5nQ291bnREaXNwbGF5KGRhdGU6IHN0cmluZywgZmxpZ2h0bnVtYmVyOiBzdHJpbmcsIG9yaWdpbjogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcblxuICAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuICAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJBcGlVc2VyXCIsIHRoaXMuaGVhZGVyQXBpdXNlcik7XG4gICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfY3VycmVuY3lcIiwgdGhpcy5oZWFkZXJDdXJyZW5jeSk7XG4gICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfc2FsZXNvZmZpY2VcIiwgdGhpcy5zYWxlc09mZmljZSk7XG4gICAgICAgICByZXR1cm4gdGhpcy5faHR0cC5nZXQodGhpcy5hY3Rpb25Vcmxmb3Jib29raW5nY291bnQgKyBkYXRlICsgXCIvXCIgKyBmbGlnaHRudW1iZXIgKyBcIi9cIiArIG9yaWdpbiArIFwiL1wiICsgXCJib29raW5nY291bnRcIiwgeyBoZWFkZXJzOiBoZWFkZXJzIH0pLm1hcChIYW5kbGVFcnJvckV4dHJhY3REYXRhLmV4dHJhY3REYXRhKS5jYXRjaChIYW5kbGVFcnJvckV4dHJhY3REYXRhLmhhbmRsZUVycm9ycyk7XG5cbiAgICAgfVxuXG5cbiAgIFxufSJdfQ==