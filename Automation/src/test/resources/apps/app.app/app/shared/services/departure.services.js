"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var http_1 = require("@angular/http");
require("rxjs/add/operator/map");
require("rxjs/add/operator/catch");
require("rxjs/add/operator/catch");
var app_constants_1 = require("../../app.constants");
var checkinorder_service_1 = require("./checkinorder.service");
var handleError_extractData_service_1 = require("./handleError_extractData.service");
var DepartureService = /** @class */ (function () {
    function DepartureService(_http, _configuration, _shared) {
        this._http = _http;
        this._configuration = _configuration;
        this._shared = _shared;
        this.parent = this;
        this.headerCurrency = this._shared.GetCurrency();
        this.salesOffice = this._shared.GetUserPointofSale();
        this.actionUrlforPaxByFlight = _configuration.ServerWithApiUrlFlights;
        this.headers = new http_1.Headers();
        this.headers.append('Content-Type', 'application/json');
        this.headers.append('Accept', 'application/json');
    }
    DepartureService.prototype.SearchDeparturesByLocationcode = function (locationcode, date, startTime, refresh) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        console.log(date + "/" + locationcode + "/flightschedule?start=" + startTime);
        if (refresh) {
            return this._http.get(this.actionUrlforPaxByFlight + date + "/" + locationcode + "/" + "flightschedule?refresh=true", { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
        }
        else {
            return this._http.get(this.actionUrlforPaxByFlight + date + "/" + locationcode + "/" + "flightschedule", { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
        }
    };
    DepartureService.prototype.SearchAllPaxByFlight = function (id, date, flightcode, locationcode) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        if (id == null || id == " " || id == "ALL") {
            return this._http.get(this.actionUrlforPaxByFlight + date + "/" + flightcode + "/" + locationcode + "/passengers" + "/all", { headers: headers })
                .map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
        }
        else {
            return this._http.get(this.actionUrlforPaxByFlight + date + "/" + flightcode + "/" + locationcode + "/passengers" + "/name" + "?pax=" + id, { headers: headers })
                .map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
            // return this._http.get("http://ustlssoat258.airservices.svcs.entsvcs.net:12499/api/flights/" + date + "/" + flightcode + "/" + locationcode + "/passengers" + "/all" + "?pax=" + id, { headers: headers })
            //         .map(HandleErrorExtractData.extractData).catch(HandleErrorExtractData.handleErrors);
        }
    };
    DepartureService = __decorate([
        core_1.Injectable(),
        __metadata("design:paramtypes", [http_1.Http, app_constants_1.Configuration, checkinorder_service_1.CheckinOrderService])
    ], DepartureService);
    return DepartureService;
}());
exports.DepartureService = DepartureService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVwYXJ0dXJlLnNlcnZpY2VzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZGVwYXJ0dXJlLnNlcnZpY2VzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsc0NBQTJDO0FBQzNDLHNDQUF3RTtBQUV4RSxpQ0FBK0I7QUFDL0IsbUNBQWlDO0FBQ2pDLG1DQUFpQztBQVFqQyxxREFBb0Q7QUFFcEQsK0RBQTZEO0FBQzdELHFGQUEyRTtBQUszRTtJQVdJLDBCQUFxQixLQUFXLEVBQVUsY0FBNkIsRUFBVSxPQUE0QjtRQUF4RixVQUFLLEdBQUwsS0FBSyxDQUFNO1FBQVUsbUJBQWMsR0FBZCxjQUFjLENBQWU7UUFBVSxZQUFPLEdBQVAsT0FBTyxDQUFxQjtRQUN6RyxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztRQUVuQixJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDakQsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLGtCQUFrQixFQUFFLENBQUM7UUFDckQsSUFBSSxDQUFDLHVCQUF1QixHQUFHLGNBQWMsQ0FBQyx1QkFBdUIsQ0FBQztRQUN0RSxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksY0FBTyxFQUFFLENBQUM7UUFDN0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLGtCQUFrQixDQUFDLENBQUM7UUFDeEQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLGtCQUFrQixDQUFDLENBQUM7SUFDdEQsQ0FBQztJQUNNLHlEQUE4QixHQUFyQyxVQUFzQyxZQUFvQixFQUFFLElBQVksRUFBRSxTQUFpQixFQUFDLE9BQWU7UUFFdkcsSUFBSSxPQUFPLEdBQUcsSUFBSSxjQUFPLEVBQUUsQ0FBQztRQUM1QixPQUFPLENBQUMsTUFBTSxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsYUFBYSxDQUFDLENB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bmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSHR0cCwgUmVzcG9uc2UsIEhlYWRlcnMsIFJlcXVlc3RPcHRpb25zIH0gZnJvbSAnQGFuZ3VsYXIvaHR0cCc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcy9SeCc7XG5pbXBvcnQgJ3J4anMvYWRkL29wZXJhdG9yL21hcCc7XG5pbXBvcnQgJ3J4anMvYWRkL29wZXJhdG9yL2NhdGNoJztcbmltcG9ydCAncnhqcy9hZGQvb3BlcmF0b3IvY2F0Y2gnO1xuaW1wb3J0ICogYXMgZGlhbG9ncyBmcm9tIFwidWkvZGlhbG9nc1wiO1xuaW1wb3J0IHsgUm91dGVyLCBOYXZpZ2F0aW9uRXh0cmFzLCBBY3RpdmF0ZWRSb3V0ZSB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5pbXBvcnQgKiBhcyBBcHBsaWNhdGlvblNldHRpbmdzIGZyb20gXCJhcHBsaWNhdGlvbi1zZXR0aW5nc1wiO1xuXG4vL2FwcCByZWZlcmVuY2VzXG5pbXBvcnQgeyBQYXNzZW5nZXIgfSBmcm9tICcuLi9tb2RlbC9pbmRleCc7XG5pbXBvcnQgeyBvcmRlciwgUGF4VGVtcGxhdGUgfSBmcm9tICcuLi9pbnRlcmZhY2UvaW5kZXgnO1xuaW1wb3J0IHsgQ29uZmlndXJhdGlvbiB9IGZyb20gJy4uLy4uL2FwcC5jb25zdGFudHMnO1xuaW1wb3J0IHsgQXBwRXhlY3V0aW9udGltZSB9IGZyb20gXCIuLi8uLi9hcHAuZXhlY3V0aW9udGltZVwiO1xuaW1wb3J0IHsgQ2hlY2tpbk9yZGVyU2VydmljZSB9IGZyb20gXCIuL2NoZWNraW5vcmRlci5zZXJ2aWNlXCI7XG5pbXBvcnQgeyBIYW5kbGVFcnJvckV4dHJhY3REYXRhIH0gZnJvbSBcIi4vaGFuZGxlRXJyb3JfZXh0cmFjdERhdGEuc2VydmljZVwiO1xuXG5cbmRlY2xhcmUgdmFyIE5TSFRUUENvb2tpZVN0b3JhZ2UsIE5TSFRUUENvb2tpZTtcbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBEZXBhcnR1cmVTZXJ2aWNlIHtcblxuICAgIHByaXZhdGUgYWN0aW9uVXJsOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBoZWFkZXJBcGl1c2VyOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBoZWFkZXJDdXJyZW5jeTogc3RyaW5nO1xuICAgIHByaXZhdGUgYWN0aW9uVXJsZm9yUGF4QnlGbGlnaHQ6IHN0cmluZztcbiAgICBwcml2YXRlIHNhbGVzT2ZmaWNlOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBoZWFkZXJzOiBIZWFkZXJzO1xuICAgIHByaXZhdGUgYWN0aW9uO1xuICAgIHByaXZhdGUgcGFyZW50OiBhbnk7XG4gICAgXG4gICAgY29uc3RydWN0b3IoIHByaXZhdGUgX2h0dHA6IEh0dHAsIHByaXZhdGUgX2NvbmZpZ3VyYXRpb246IENvbmZpZ3VyYXRpb24sIHByaXZhdGUgX3NoYXJlZDogQ2hlY2tpbk9yZGVyU2VydmljZSkge1xuICAgICAgICB0aGlzLnBhcmVudCA9IHRoaXM7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmhlYWRlckN1cnJlbmN5ID0gdGhpcy5fc2hhcmVkLkdldEN1cnJlbmN5KCk7XG4gICAgICAgIHRoaXMuc2FsZXNPZmZpY2UgPSB0aGlzLl9zaGFyZWQuR2V0VXNlclBvaW50b2ZTYWxlKCk7XG4gICAgICAgIHRoaXMuYWN0aW9uVXJsZm9yUGF4QnlGbGlnaHQgPSBfY29uZmlndXJhdGlvbi5TZXJ2ZXJXaXRoQXBpVXJsRmxpZ2h0cztcbiAgICAgICAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgICAgdGhpcy5oZWFkZXJzLmFwcGVuZCgnQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcbiAgICAgICAgdGhpcy5oZWFkZXJzLmFwcGVuZCgnQWNjZXB0JywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcbiAgICB9XG4gICAgcHVibGljIFNlYXJjaERlcGFydHVyZXNCeUxvY2F0aW9uY29kZShsb2NhdGlvbmNvZGU6IHN0cmluZywgZGF0ZTogc3RyaW5nLCBzdGFydFRpbWU6IHN0cmluZyxyZWZyZXNoOmJvb2xlYW4pOiBPYnNlcnZhYmxlPGFueT4ge1xuXG4gICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJBcGlVc2VyXCIsIHRoaXMuaGVhZGVyQXBpdXNlcik7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiaHR0cF9jdXJyZW5jeVwiLCB0aGlzLmhlYWRlckN1cnJlbmN5KTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX3NhbGVzb2ZmaWNlXCIsIHRoaXMuc2FsZXNPZmZpY2UpO1xuICAgICAgICBjb25zb2xlLmxvZyhkYXRlICsgXCIvXCIgKyBsb2NhdGlvbmNvZGUgKyBcIi9mbGlnaHRzY2hlZHVsZT9zdGFydD1cIiArIHN0YXJ0VGltZSk7XG4gICAgICAgIGlmKHJlZnJlc2gpe1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAuZ2V0KHRoaXMuYWN0aW9uVXJsZm9yUGF4QnlGbGlnaHQgKyBkYXRlICsgXCIvXCIgKyBsb2NhdGlvbmNvZGUgKyBcIi9cIiArIFwiZmxpZ2h0c2NoZWR1bGU/cmVmcmVzaD10cnVlXCIsIHsgaGVhZGVyczogaGVhZGVycyB9KS5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSkuY2F0Y2goSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5oYW5kbGVFcnJvcnMpO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9odHRwLmdldCh0aGlzLmFjdGlvblVybGZvclBheEJ5RmxpZ2h0ICsgZGF0ZSArIFwiL1wiICsgbG9jYXRpb25jb2RlICsgXCIvXCIgKyBcImZsaWdodHNjaGVkdWxlXCIsIHsgaGVhZGVyczogaGVhZGVycyB9KS5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSkuY2F0Y2goSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5oYW5kbGVFcnJvcnMpO1xuICAgICAgICB9XG5cbiAgICB9XG4gICAgcHVibGljIFNlYXJjaEFsbFBheEJ5RmxpZ2h0KGlkOiBzdHJpbmcsIGRhdGU6IHN0cmluZywgZmxpZ2h0Y29kZTogc3RyaW5nLCBsb2NhdGlvbmNvZGU6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XG5cblxuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiQXBpVXNlclwiLCB0aGlzLmhlYWRlckFwaXVzZXIpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfY3VycmVuY3lcIiwgdGhpcy5oZWFkZXJDdXJyZW5jeSk7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiaHR0cF9zYWxlc29mZmljZVwiLCB0aGlzLnNhbGVzT2ZmaWNlKTtcbiAgICAgICAgaWYgKGlkID09IG51bGwgfHwgaWQgPT0gXCIgXCIgfHwgaWQgPT0gXCJBTExcIikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAuZ2V0KHRoaXMuYWN0aW9uVXJsZm9yUGF4QnlGbGlnaHQgKyBkYXRlICsgXCIvXCIgKyBmbGlnaHRjb2RlICsgXCIvXCIgKyBsb2NhdGlvbmNvZGUgKyBcIi9wYXNzZW5nZXJzXCIgKyBcIi9hbGxcIiwgeyBoZWFkZXJzOiBoZWFkZXJzIH0pXG4gICAgICAgICAgICAgICAgLm1hcChIYW5kbGVFcnJvckV4dHJhY3REYXRhLmV4dHJhY3REYXRhKS5jYXRjaChIYW5kbGVFcnJvckV4dHJhY3REYXRhLmhhbmRsZUVycm9ycyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faHR0cC5nZXQodGhpcy5hY3Rpb25Vcmxmb3JQYXhCeUZsaWdodCArIGRhdGUgKyBcIi9cIiArIGZsaWdodGNvZGUgKyBcIi9cIiArIGxvY2F0aW9uY29kZSArIFwiL3Bhc3NlbmdlcnNcIiArIFwiL25hbWVcIiArIFwiP3BheD1cIiArIGlkLCB7IGhlYWRlcnM6IGhlYWRlcnMgfSlcbiAgICAgICAgICAgICAgICAubWFwKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuZXh0cmFjdERhdGEpLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcbiAgICAgICAgICAgIC8vIHJldHVybiB0aGlzLl9odHRwLmdldChcImh0dHA6Ly91c3Rsc3NvYXQyNTguYWlyc2VydmljZXMuc3Zjcy5lbnRzdmNzLm5ldDoxMjQ5OS9hcGkvZmxpZ2h0cy9cIiArIGRhdGUgKyBcIi9cIiArIGZsaWdodGNvZGUgKyBcIi9cIiArIGxvY2F0aW9uY29kZSArIFwiL3Bhc3NlbmdlcnNcIiArIFwiL2FsbFwiICsgXCI/cGF4PVwiICsgaWQsIHsgaGVhZGVyczogaGVhZGVycyB9KVxuICAgICAgICAgICAgLy8gICAgICAgICAubWFwKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuZXh0cmFjdERhdGEpLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcblxuICAgICAgICB9XG5cblxuICAgIH1cblxuXG59Il19