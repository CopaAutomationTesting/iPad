"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
//angular & nativescript references
var core_1 = require("@angular/core");
var http_1 = require("@angular/http");
var Rx_1 = require("rxjs/Rx");
require("rxjs/add/operator/map");
require("rxjs/add/operator/catch");
require("rxjs/add/operator/catch");
var router_1 = require("nativescript-angular/router");
var app_constants_1 = require("../../app.constants");
var checkinorder_service_1 = require("./checkinorder.service");
var handleError_extractData_service_1 = require("./handleError_extractData.service");
var DataService = /** @class */ (function () {
    function DataService(routerExtensions, _http, _configuration, _shared) {
        this.routerExtensions = routerExtensions;
        this._http = _http;
        this._configuration = _configuration;
        this._shared = _shared;
        this.parent = this;
        this.actionUrlforLogin = _configuration.ServerWithApiUrlForSiteminderLogin;
        this.actionUrl = _configuration.ServerWithApiUrlEmd;
        this.headerApiuser = _configuration.HeaderApiuser;
        // this.officeName =_configuration.OfficeName;
        this.headerCurrency = this._shared.GetCurrency();
        this.salesOffice = this._shared.GetUserPointofSale();
        console.log(this.salesOffice);
        this.actionUrlforPaxOrderID = _configuration.ServerWithApiUrlOrders;
        this.actionUrlforPaxByFlight = _configuration.ServerWithApiUrlFlights;
        this.actionUrlforCheckIn = _configuration.ServerWithApiUrlCheckin;
        this.actionUrlforBaggage = _configuration.ServerWithApiUrlBaggage;
        this.actionUrlforPrice = _configuration.ServerWithApiUrlPrice;
        this.actionUrlforProfile = _configuration.ServerWithApiUrlProfile;
        this.actionUrlforSeatMap = _configuration.ServerWithApiUrlSeatMap;
        this.actionUrlforAssignSeat = _configuration.ServerWithApiUrlAssignSeat;
        this.actionUrlforbookingcount = _configuration.ServerWithApiUrlbookingcount;
        this.actionUrlforOffload = _configuration.ServerWithApiUrlOffload;
        this.actionUrlforBagTag = _configuration.ServerWithApiUrlBagTag;
        this.actionUrlforFQTV = _configuration.ServerWithApiUrlFQTV;
        this.actionUrlforDevicePrinter = _configuration.ServerWithApiUrlPrinterDevice;
        this.actionUrlforWorkStation = _configuration.ServerWithApiUrlWorkStation;
        this.actionUrlforPrinting = _configuration.HostPrinter;
        this.actionURLDRS = _configuration.CompensationType;
        this.headers = new http_1.Headers();
        this.headers.append('Content-Type', 'application/json');
        this.headers.append('Accept', 'application/json');
    }
    DataService.prototype.documentType = function () {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        console.log(this.actionUrlforPrinting);
        return this._http.get(this.actionUrlforPrinting + 'reference?get=adcscreen', { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    // public getCityService(): Observable<any> {
    //     let headers = new Headers();
    //     headers.append("ApiUser", this.headerApiuser);
    //     return this._http.get(this.actionUrlforPrinting+"locations", { headers: headers })
    //         .map(response => response.json())
    //         .catch(HandleErrorExtractData.handleErrors);
    // }
    DataService.prototype.SearchEMDByPNR = function (id) {
        var sDate = new Date();
        console.log('SearchEMDByPNR Service --------------- Start Date Time : ' + sDate);
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.get(this.actionUrl + "search?query=y&id=" + id, { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    DataService.prototype.SearchOfficeNameByWorkStation = function (WorkstationRequest) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        console.log(JSON.stringify(WorkstationRequest));
        return this._http.get(this.actionUrlforDevicePrinter + WorkstationRequest + "?OfficeName=true", { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    DataService.prototype.SearchPrinterDeviceByWorkStation = function (WorkstationName) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        console.log(JSON.stringify(this.actionUrlforDevicePrinter + WorkstationName));
        return this._http.get(this.actionUrlforDevicePrinter + WorkstationName, { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    DataService.prototype.GetBaggage = function (request, orderID) {
        console.log(request);
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.post(this.actionUrlforBaggage + orderID, JSON.stringify(request), { headers: headers })
            .map(handleError_extractData_service_1.HandleErrorExtractData.extractData)
            .catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    DataService.prototype.GetPrice = function (request, currency) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        console.log(currency);
        headers.append("http_currency", currency);
        return this._http.post(this.actionUrlforPrice, JSON.stringify(request), { headers: headers })
            .map(handleError_extractData_service_1.HandleErrorExtractData.extractData)
            .catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    DataService.prototype.GetFlightInfo = function (flightcode, date) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.get(this.actionUrlforPaxByFlight + date + "/" + flightcode + "?origin=" + this.salesOffice.substr(0, 3), { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    DataService.prototype.FQTV = function () {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.get(this.actionUrlforFQTV, { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    DataService.prototype.Tier = function (date, flightnumber, city) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.get(this.actionUrlforPaxByFlight + date + "/" + flightnumber + "/" + city + "/passengers/all", { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    DataService.prototype.Status = function (date, flightnumber, DepatureCity) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.get(this.actionUrlforPaxByFlight + date + "/" + flightnumber + "?departure=" + DepatureCity, { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    DataService.prototype.StatusCompensation = function (date, flightnumber) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.get(this.actionUrlforPaxByFlight + date + "/" + flightnumber, { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    DataService.prototype.UpgradeOrDownGradeChanges = function (request) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.post(this.actionUrlforCheckIn + "upgrade", JSON.parse(JSON.stringify(request)), { headers: headers })
            .map(handleError_extractData_service_1.HandleErrorExtractData.extractData);
    };
    DataService.prototype.BookingCountDisplay = function (date, flightnumber, origin) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.get(this.actionUrlforbookingcount + date + "/" + flightnumber + "/" + origin + "/" + "bookingcount", { headers: headers }).map(handleError_extractData_service_1.HandleErrorExtractData.extractData).catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    DataService.prototype.GetBagTag = function (request) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.post(this.actionUrlforBagTag, JSON.parse(JSON.stringify(request)), { headers: headers })
            .map(handleError_extractData_service_1.HandleErrorExtractData.extractData)
            .catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    DataService.prototype.extractData = function (res) {
        console.log(res);
        if (res.text().indexOf('Siteminder - Login') > -1) {
            throw "SessionTimeout";
        }
        var body = res.json();
        if (body.BadRequest != undefined) {
            if (body.ErrorMessage != undefined) {
                throw (body.ErrorMessage);
            }
            else {
                throw (body.genericMessage);
            }
        }
        return body;
    };
    DataService.prototype.handleError = function (error) {
        console.log("Handler Ready");
        var cookies = NSHTTPCookieStorage.sharedHTTPCookieStorage.cookies;
        if (typeof cookies !== 'undefined') {
            //     this.Output = "No Cookie(s) Available";
            for (var i = 0; i < cookies.count; i++) {
                var cookie = cookies.objectAtIndex(i);
                if (cookie.name == "SMSESSION")
                    console.log(cookie);
            }
            console.error("Error from Service " + error);
            // var errorMessage = error.toString();
            // if (errorMessage.indexOf("Unrecognized token '<'") == -1) {
            //     console.log("hi");
            //     return Observable.throw(error.json().data || 'Server error');
            // }
            // else {
            //     console.log("else");
            //     return Observable.throw(error);
            // }
            if (error.status === 0) {
                return Rx_1.Observable.throw('Unable to Connect. Verify Network.');
            }
            else if (error.status == 200) {
                return Rx_1.Observable.throw('Unable to connect to server. Network Error.');
            }
            else if (error.status == 400) {
                return Rx_1.Observable.throw('Unable to get response. Bad Request. [400]');
            }
            else if (error.status == 404) {
                return Rx_1.Observable.throw('Unable to connect to server. Network Error. [404]');
            }
            else if (error.status == 500) {
                return Rx_1.Observable.throw('Internal Server Error [500].');
            }
            else if (error.status == 502) {
                return Rx_1.Observable.throw('unable to received a valid response.Bad GateWay [502]');
            }
            else {
                return Rx_1.Observable.throw(error);
            }
        }
        else {
            console.error("Error " + error);
            console.log("Handler Ready");
            console.log("hi");
            // this.displayStandardproductsDialog();                        
            return Rx_1.Observable.throw(cookies || 'Server error');
        }
    };
    DataService.prototype.FQTVUpdate = function (request, OrderId) {
        var headers = new http_1.Headers();
        headers.append("ApiUser", this.headerApiuser);
        headers.append("http_currency", this.headerCurrency);
        headers.append("http_salesoffice", this.salesOffice);
        return this._http.post(this.actionUrlforPaxOrderID + OrderId + "/traveler/update", JSON.parse(JSON.stringify(request)), { headers: headers })
            .map(handleError_extractData_service_1.HandleErrorExtractData.extractData)
            .catch(handleError_extractData_service_1.HandleErrorExtractData.handleErrors);
    };
    DataService = __decorate([
        core_1.Injectable(),
        __metadata("design:paramtypes", [router_1.RouterExtensions, http_1.Http, app_constants_1.Configuration, checkinorder_service_1.CheckinOrderService])
    ], DataService);
    return DataService;
}());
exports.DataService = DataService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFzc2VuZ2VyLWxpc3Quc2VydmljZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJwYXNzZW5nZXItbGlzdC5zZXJ2aWNlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG1DQUFtQztBQUNuQyxzQ0FBMkM7QUFDM0Msc0NBQXdFO0FBQ3hFLDhCQUFxQztBQUNyQyxpQ0FBK0I7QUFDL0IsbUNBQWlDO0FBQ2pDLG1DQUFpQztBQUVqQyxzREFBK0Q7QUFPL0QscURBQW9EO0FBRXBELCtEQUE2RDtBQUM3RCxxRkFBMkU7QUFNM0U7SUE0QkkscUJBQW9CLGdCQUFrQyxFQUFVLEtBQVcsRUFBVSxjQUE2QixFQUFVLE9BQTRCO1FBQXBJLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBa0I7UUFBVSxVQUFLLEdBQUwsS0FBSyxDQUFNO1FBQVUsbUJBQWMsR0FBZCxjQUFjLENBQWU7UUFBVSxZQUFPLEdBQVAsT0FBTyxDQUFxQjtRQUNwSixJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztRQUNuQixJQUFJLENBQUMsaUJBQWlCLEdBQUcsY0FBYyxDQUFDLGtDQUFrQyxDQUFDO1FBQzNFLElBQUksQ0FBQyxTQUFTLEdBQUcsY0FBYyxDQUFDLG1CQUFtQixDQUFDO1FBQ3BELElBQUksQ0FBQyxhQUFhLEdBQUcsY0FBYyxDQUFDLGFBQWEsQ0FBQztRQUNsRCw4Q0FBOEM7UUFDOUMsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ2pELElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1FBQ3JELE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQzlCLElBQUksQ0FBQyxzQkFBc0IsR0FBRyxjQUFjLENBQUMsc0JBQXNCLENBQUM7UUFDcEUsSUFBSSxDQUFDLHVCQUF1QixHQUFHLGNBQWMsQ0FBQyx1QkFB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QUVNLGdDQUFVLEdBQWpCLFVBQWtCLE9BQVksRUFBRSxPQUFlO1FBQzNDLElBQUksT0FBTyxHQUFHLElBQUksY0FBTyxFQUFFLENBQUM7UUFDNUIsT0FBTyxDQUFDLE1BQU0sQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQzlDLE9BQU8sQ0FBQyxNQUFNLENBQUMsZUFBZSxFQUFFLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUNyRCxPQUFPLENBQUMsTUFBTSxDQUFDLGtCQUFrQixFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUNyRCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsR0FBRyxPQUFPLEdBQUcsa0JBQWtCLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLENBQUM7YUFDeEksR0FBRyxDQUFDLHdEQUFzQixDQUFDLFdBQVcsQ0FBQzthQUN2QyxLQUFLLENBQUMsd0RBQXNCLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDcEQsQ0FBQztJQTlTUSxXQUFXO1FBRHZCLGlCQUFVLEVBQUU7eUNBNkI2Qix5QkFBZ0IsRUFBaUIsV0FBSSxFQUEwQiw2QkFBYSxFQUFtQiwwQ0FBbUI7T0E1Qi9JLFdBQVcsQ0FnVHZCO0lBQUQsa0JBQUM7Q0FBQSxBQWhURCxJQWdUQztBQWhUWSxrQ0FBVyIsInNvdXJjZXNDb250ZW50IjpbIi8vYW5ndWxhciAmIG5hdGl2ZXNjcmlwdCByZWZlcmVuY2VzXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBIdHRwLCBSZXNwb25zZSwgSGVhZGVycywgUmVxdWVzdE9wdGlvbnMgfSBmcm9tICdAYW5ndWxhci9odHRwJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzL1J4JztcbmltcG9ydCAncnhqcy9hZGQvb3BlcmF0b3IvbWFwJztcbmltcG9ydCAncnhqcy9hZGQvb3BlcmF0b3IvY2F0Y2gnO1xuaW1wb3J0ICdyeGpzL2FkZC9vcGVyYXRvci9jYXRjaCc7XG5pbXBvcnQgKiBhcyBkaWFsb2dzIGZyb20gXCJ1aS9kaWFsb2dzXCI7XG5pbXBvcnQgeyBSb3V0ZXJFeHRlbnNpb25zIH0gZnJvbSBcIm5hdGl2ZXNjcmlwdC1hbmd1bGFyL3JvdXRlclwiO1xuaW1wb3J0IHsgUm91dGVyLCBOYXZpZ2F0aW9uRXh0cmFzLCBBY3RpdmF0ZWRSb3V0ZSB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5pbXBvcnQgKiBhcyBBcHBsaWNhdGlvblNldHRpbmdzIGZyb20gXCJhcHBsaWNhdGlvbi1zZXR0aW5nc1wiO1xuXG4vL2FwcCByZWZlcmVuY2VzXG5pbXBvcnQgeyBQYXNzZW5nZXIgfSBmcm9tICcuLi9tb2RlbC9pbmRleCc7XG5pbXBvcnQgeyBvcmRlciwgUGF4VGVtcGxhdGUgfSBmcm9tICcuLi9pbnRlcmZhY2UvaW5kZXgnO1xuaW1wb3J0IHsgQ29uZmlndXJhdGlvbiB9IGZyb20gJy4uLy4uL2FwcC5jb25zdGFudHMnO1xuaW1wb3J0IHsgQXBwRXhlY3V0aW9udGltZSB9IGZyb20gXCIuLi8uLi9hcHAuZXhlY3V0aW9udGltZVwiO1xuaW1wb3J0IHsgQ2hlY2tpbk9yZGVyU2VydmljZSB9IGZyb20gXCIuL2NoZWNraW5vcmRlci5zZXJ2aWNlXCI7XG5pbXBvcnQgeyBIYW5kbGVFcnJvckV4dHJhY3REYXRhIH0gZnJvbSBcIi4vaGFuZGxlRXJyb3JfZXh0cmFjdERhdGEuc2VydmljZVwiO1xuXG5cbmRlY2xhcmUgdmFyIE5TSFRUUENvb2tpZVN0b3JhZ2UsIE5TSFRUUENvb2tpZTtcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIERhdGFTZXJ2aWNlIHtcblxuICAgIHByaXZhdGUgYWN0aW9uVXJsOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBoZWFkZXJBcGl1c2VyOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBoZWFkZXJDdXJyZW5jeTogc3RyaW5nO1xuICAgIHByaXZhdGUgYWN0aW9uVXJsZm9yUGF4T3JkZXJJRDogc3RyaW5nO1xuICAgIHByaXZhdGUgYWN0aW9uVXJsZm9yUGF4QnlGbGlnaHQ6IHN0cmluZztcbiAgICBwcml2YXRlIGFjdGlvblVybGZvckNoZWNrSW46IHN0cmluZztcbiAgICBwcml2YXRlIGFjdGlvblVybGZvclByb2ZpbGU6IHN0cmluZztcbiAgICBwcml2YXRlIG9mZmljZU5hbWU6c3RyaW5nO1xuICAgIHByaXZhdGUgc2FsZXNPZmZpY2U6IHN0cmluZztcbiAgICBwcml2YXRlIGhlYWRlcnM6IEhlYWRlcnM7XG4gICAgcHVibGljIFBhc3NlbmdlckRldGFpbHM6IG9yZGVyO1xuICAgIHByaXZhdGUgYWN0aW9uVXJsZm9yQmFnZ2FnZTogc3RyaW5nO1xuICAgIHByaXZhdGUgYWN0aW9uVXJsZm9yUHJpY2U6IHN0cmluZztcbiAgICBwcml2YXRlIGFjdGlvblVybGZvclNlYXRNYXA6IHN0cmluZztcbiAgICBwcml2YXRlIGFjdGlvblVybGZvckFzc2lnblNlYXQ6IHN0cmluZztcbiAgICBwcml2YXRlIGFjdGlvblVybGZvcmJvb2tpbmdjb3VudDogc3RyaW5nO1xuICAgIHByaXZhdGUgYWN0aW9uVXJsZm9yT2ZmbG9hZDogc3RyaW5nO1xuICAgIHByaXZhdGUgYWN0aW9uVXJsZm9yQmFnVGFnOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBhY3Rpb25Vcmxmb3JGUVRWOiBzdHJpbmdcbiAgICBwcml2YXRlIGFjdGlvblVybGZvckxvZ2luOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBhY3Rpb25Vcmxmb3JEZXZpY2VQcmludGVyOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBhY3Rpb25Vcmxmb3JXb3JrU3RhdGlvbjogc3RyaW5nO1xuICAgIHByaXZhdGUgYWN0aW9uO1xuICAgIHByaXZhdGUgcGFyZW50OiBhbnk7XG4gICAgcHJpdmF0ZSBhY3Rpb25Vcmxmb3JQcmludGluZzogc3RyaW5nO1xuICAgIHByaXZhdGUgYWN0aW9uVVJMRFJTOnN0cmluZztcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJvdXRlckV4dGVuc2lvbnM6IFJvdXRlckV4dGVuc2lvbnMsIHByaXZhdGUgX2h0dHA6IEh0dHAsIHByaXZhdGUgX2NvbmZpZ3VyYXRpb246IENvbmZpZ3VyYXRpb24sIHByaXZhdGUgX3NoYXJlZDogQ2hlY2tpbk9yZGVyU2VydmljZSkge1xuICAgICAgICB0aGlzLnBhcmVudCA9IHRoaXM7XG4gICAgICAgIHRoaXMuYWN0aW9uVXJsZm9yTG9naW4gPSBfY29uZmlndXJhdGlvbi5TZXJ2ZXJXaXRoQXBpVXJsRm9yU2l0ZW1pbmRlckxvZ2luO1xuICAgICAgICB0aGlzLmFjdGlvblVybCA9IF9jb25maWd1cmF0aW9uLlNlcnZlcldpdGhBcGlVcmxFbWQ7XG4gICAgICAgIHRoaXMuaGVhZGVyQXBpdXNlciA9IF9jb25maWd1cmF0aW9uLkhlYWRlckFwaXVzZXI7XG4gICAgICAgIC8vIHRoaXMub2ZmaWNlTmFtZSA9X2NvbmZpZ3VyYXRpb24uT2ZmaWNlTmFtZTtcbiAgICAgICAgdGhpcy5oZWFkZXJDdXJyZW5jeSA9IHRoaXMuX3NoYXJlZC5HZXRDdXJyZW5jeSgpO1xuICAgICAgICB0aGlzLnNhbGVzT2ZmaWNlID0gdGhpcy5fc2hhcmVkLkdldFVzZXJQb2ludG9mU2FsZSgpO1xuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnNhbGVzT2ZmaWNlKTtcbiAgICAgICAgdGhpcy5hY3Rpb25Vcmxmb3JQYXhPcmRlcklEID0gX2NvbmZpZ3VyYXRpb24uU2VydmVyV2l0aEFwaVVybE9yZGVycztcbiAgICAgICAgdGhpcy5hY3Rpb25Vcmxmb3JQYXhCeUZsaWdodCA9IF9jb25maWd1cmF0aW9uLlNlcnZlcldpdGhBcGlVcmxGbGlnaHRzO1xuICAgICAgICB0aGlzLmFjdGlvblVybGZvckNoZWNrSW4gPSBfY29uZmlndXJhdGlvbi5TZXJ2ZXJXaXRoQXBpVXJsQ2hlY2tpbjtcbiAgICAgICAgdGhpcy5hY3Rpb25Vcmxmb3JCYWdnYWdlID0gX2NvbmZpZ3VyYXRpb24uU2VydmVyV2l0aEFwaVVybEJhZ2dhZ2U7XG4gICAgICAgIHRoaXMuYWN0aW9uVXJsZm9yUHJpY2UgPSBfY29uZmlndXJhdGlvbi5TZXJ2ZXJXaXRoQXBpVXJsUHJpY2U7XG4gICAgICAgIHRoaXMuYWN0aW9uVXJsZm9yUHJvZmlsZSA9IF9jb25maWd1cmF0aW9uLlNlcnZlcldpdGhBcGlVcmxQcm9maWxlO1xuICAgICAgICB0aGlzLmFjdGlvblVybGZvclNlYXRNYXAgPSBfY29uZmlndXJhdGlvbi5TZXJ2ZXJXaXRoQXBpVXJsU2VhdE1hcDtcbiAgICAgICAgdGhpcy5hY3Rpb25Vcmxmb3JBc3NpZ25TZWF0ID0gX2NvbmZpZ3VyYXRpb24uU2VydmVyV2l0aEFwaVVybEFzc2lnblNlYXQ7XG4gICAgICAgIHRoaXMuYWN0aW9uVXJsZm9yYm9va2luZ2NvdW50ID0gX2NvbmZpZ3VyYXRpb24uU2VydmVyV2l0aEFwaVVybGJvb2tpbmdjb3VudDtcbiAgICAgICAgdGhpcy5hY3Rpb25Vcmxmb3JPZmZsb2FkID0gX2NvbmZpZ3VyYXRpb24uU2VydmVyV2l0aEFwaVVybE9mZmxvYWQ7XG4gICAgICAgIHRoaXMuYWN0aW9uVXJsZm9yQmFnVGFnID0gX2NvbmZpZ3VyYXRpb24uU2VydmVyV2l0aEFwaVVybEJhZ1RhZztcbiAgICAgICAgdGhpcy5hY3Rpb25Vcmxmb3JGUVRWID0gX2NvbmZpZ3VyYXRpb24uU2VydmVyV2l0aEFwaVVybEZRVFY7XG4gICAgICAgIHRoaXMuYWN0aW9uVXJsZm9yRGV2aWNlUHJpbnRlciA9IF9jb25maWd1cmF0aW9uLlNlcnZlcldpdGhBcGlVcmxQcmludGVyRGV2aWNlO1xuICAgICAgICB0aGlzLmFjdGlvblVybGZvcldvcmtTdGF0aW9uID0gX2NvbmZpZ3VyYXRpb24uU2VydmVyV2l0aEFwaVVybFdvcmtTdGF0aW9uO1xuICAgICAgICB0aGlzLmFjdGlvblVybGZvclByaW50aW5nID0gX2NvbmZpZ3VyYXRpb24uSG9zdFByaW50ZXI7XG4gICAgICAgIHRoaXMuYWN0aW9uVVJMRFJTPV9jb25maWd1cmF0aW9uLkNvbXBlbnNhdGlvblR5cGU7XG4gICAgICAgIHRoaXMuaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICAgIHRoaXMuaGVhZGVycy5hcHBlbmQoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgICAgIHRoaXMuaGVhZGVycy5hcHBlbmQoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgfVxuXG4gICAgcHVibGljIGRvY3VtZW50VHlwZSgpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiQXBpVXNlclwiLCB0aGlzLmhlYWRlckFwaXVzZXIpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfY3VycmVuY3lcIiwgdGhpcy5oZWFkZXJDdXJyZW5jeSk7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiaHR0cF9zYWxlc29mZmljZVwiLCB0aGlzLnNhbGVzT2ZmaWNlKTtcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5hY3Rpb25Vcmxmb3JQcmludGluZylcbiAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAuZ2V0KHRoaXMuYWN0aW9uVXJsZm9yUHJpbnRpbmcgKyAncmVmZXJlbmNlP2dldD1hZGNzY3JlZW4nLCB7IGhlYWRlcnM6IGhlYWRlcnMgfSkubWFwKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuZXh0cmFjdERhdGEpLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcbiAgICB9XG5cbiAgICAvLyBwdWJsaWMgZ2V0Q2l0eVNlcnZpY2UoKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICAvLyAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuICAgIC8vICAgICBoZWFkZXJzLmFwcGVuZChcIkFwaVVzZXJcIiwgdGhpcy5oZWFkZXJBcGl1c2VyKTtcbiAgICAvLyAgICAgcmV0dXJuIHRoaXMuX2h0dHAuZ2V0KHRoaXMuYWN0aW9uVXJsZm9yUHJpbnRpbmcrXCJsb2NhdGlvbnNcIiwgeyBoZWFkZXJzOiBoZWFkZXJzIH0pXG4gICAgLy8gICAgICAgICAubWFwKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcbiAgICAvLyAgICAgICAgIC5jYXRjaChIYW5kbGVFcnJvckV4dHJhY3REYXRhLmhhbmRsZUVycm9ycyk7XG4gICAgLy8gfVxuXG4gICAgXG5cbiAgICBwdWJsaWMgU2VhcmNoRU1EQnlQTlIoaWQ6IHN0cmluZyk6IE9ic2VydmFibGU8UGFzc2VuZ2VyPiB7XG5cbiAgICAgICAgdmFyIHNEYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1NlYXJjaEVNREJ5UE5SIFNlcnZpY2UgLS0tLS0tLS0tLS0tLS0tIFN0YXJ0IERhdGUgVGltZSA6ICcgKyBzRGF0ZSk7XG4gICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJBcGlVc2VyXCIsIHRoaXMuaGVhZGVyQXBpdXNlcik7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiaHR0cF9jdXJyZW5jeVwiLCB0aGlzLmhlYWRlckN1cnJlbmN5KTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX3NhbGVzb2ZmaWNlXCIsIHRoaXMuc2FsZXNPZmZpY2UpO1xuICAgICAgICByZXR1cm4gdGhpcy5faHR0cC5nZXQodGhpcy5hY3Rpb25VcmwgKyBcInNlYXJjaD9xdWVyeT15JmlkPVwiICsgaWQsIHsgaGVhZGVyczogaGVhZGVycyB9KS5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSkuY2F0Y2goSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5oYW5kbGVFcnJvcnMpO1xuXG4gICAgfVxuXG4gICAgXG4gICAgXG4gICAgcHVibGljIFNlYXJjaE9mZmljZU5hbWVCeVdvcmtTdGF0aW9uKFdvcmtzdGF0aW9uUmVxdWVzdDogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcblxuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiQXBpVXNlclwiLCB0aGlzLmhlYWRlckFwaXVzZXIpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfY3VycmVuY3lcIiwgdGhpcy5oZWFkZXJDdXJyZW5jeSk7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiaHR0cF9zYWxlc29mZmljZVwiLCB0aGlzLnNhbGVzT2ZmaWNlKTtcbiAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoV29ya3N0YXRpb25SZXF1ZXN0KSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9odHRwLmdldCh0aGlzLmFjdGlvblVybGZvckRldmljZVByaW50ZXIrV29ya3N0YXRpb25SZXF1ZXN0K1wiP09mZmljZU5hbWU9dHJ1ZVwiLCB7IGhlYWRlcnM6IGhlYWRlcnMgfSkubWFwKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuZXh0cmFjdERhdGEpLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcblxuICAgIH1cblxuICAgIHB1YmxpYyBTZWFyY2hQcmludGVyRGV2aWNlQnlXb3JrU3RhdGlvbihXb3Jrc3RhdGlvbk5hbWU6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIFxuICAgICAgICAgICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLmFwcGVuZChcIkFwaVVzZXJcIiwgdGhpcy5oZWFkZXJBcGl1c2VyKTtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfY3VycmVuY3lcIiwgdGhpcy5oZWFkZXJDdXJyZW5jeSk7XG4gICAgICAgICAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX3NhbGVzb2ZmaWNlXCIsIHRoaXMuc2FsZXNPZmZpY2UpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHRoaXMuYWN0aW9uVXJsZm9yRGV2aWNlUHJpbnRlciArIFdvcmtzdGF0aW9uTmFtZSkpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9odHRwLmdldCh0aGlzLmFjdGlvblVybGZvckRldmljZVByaW50ZXIgKyBXb3Jrc3RhdGlvbk5hbWUsIHsgaGVhZGVyczogaGVhZGVycyB9KS5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSkuY2F0Y2goSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5oYW5kbGVFcnJvcnMpO1xuICAgICAgICBcbiAgICAgICAgICAgIH1cblxuICAgIHB1YmxpYyBHZXRCYWdnYWdlKHJlcXVlc3Q6YW55LG9yZGVySUQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlcXVlc3QpO1xuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiQXBpVXNlclwiLCB0aGlzLmhlYWRlckFwaXVzZXIpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfY3VycmVuY3lcIiwgdGhpcy5oZWFkZXJDdXJyZW5jeSk7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiaHR0cF9zYWxlc29mZmljZVwiLCB0aGlzLnNhbGVzT2ZmaWNlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAucG9zdCh0aGlzLmFjdGlvblVybGZvckJhZ2dhZ2UgKyBvcmRlcklELEpTT04uc3RyaW5naWZ5KHJlcXVlc3QpLCB7IGhlYWRlcnM6IGhlYWRlcnMgfSlcbiAgICAgICAgICAgIC5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSlcblxuICAgICAgICAgICAgLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcblxuICAgIH1cblxuICAgIHB1YmxpYyBHZXRQcmljZShyZXF1ZXN0OiBhbnksIGN1cnJlbmN5OiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xuXG4gICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJBcGlVc2VyXCIsIHRoaXMuaGVhZGVyQXBpdXNlcik7XG4gICAgICAgIGNvbnNvbGUubG9nKGN1cnJlbmN5KTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX2N1cnJlbmN5XCIsIGN1cnJlbmN5KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAucG9zdCh0aGlzLmFjdGlvblVybGZvclByaWNlLCBKU09OLnN0cmluZ2lmeShyZXF1ZXN0KSwgeyBoZWFkZXJzOiBoZWFkZXJzIH0pXG4gICAgICAgICAgICAubWFwKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuZXh0cmFjdERhdGEpXG5cbiAgICAgICAgICAgIC5jYXRjaChIYW5kbGVFcnJvckV4dHJhY3REYXRhLmhhbmRsZUVycm9ycyk7XG5cbiAgICB9XG5cbiAgICBcblxuICAgIHB1YmxpYyBHZXRGbGlnaHRJbmZvKGZsaWdodGNvZGU6IHN0cmluZywgZGF0ZTogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcblxuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiQXBpVXNlclwiLCB0aGlzLmhlYWRlckFwaXVzZXIpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfY3VycmVuY3lcIiwgdGhpcy5oZWFkZXJDdXJyZW5jeSk7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiaHR0cF9zYWxlc29mZmljZVwiLCB0aGlzLnNhbGVzT2ZmaWNlKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLl9odHRwLmdldCh0aGlzLmFjdGlvblVybGZvclBheEJ5RmxpZ2h0ICsgZGF0ZSArIFwiL1wiICsgZmxpZ2h0Y29kZSArIFwiP29yaWdpbj1cIiArIHRoaXMuc2FsZXNPZmZpY2Uuc3Vic3RyKDAsMyksIHsgaGVhZGVyczogaGVhZGVycyB9KS5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSkuY2F0Y2goSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5oYW5kbGVFcnJvcnMpO1xuICAgIH1cblxuICAgIHB1YmxpYyBGUVRWKCk6IE9ic2VydmFibGU8YW55PiB7XG5cbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcIkFwaVVzZXJcIiwgdGhpcy5oZWFkZXJBcGl1c2VyKTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX2N1cnJlbmN5XCIsIHRoaXMuaGVhZGVyQ3VycmVuY3kpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfc2FsZXNvZmZpY2VcIiwgdGhpcy5zYWxlc09mZmljZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9odHRwLmdldCh0aGlzLmFjdGlvblVybGZvckZRVFYsIHsgaGVhZGVyczogaGVhZGVycyB9KS5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSkuY2F0Y2goSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5oYW5kbGVFcnJvcnMpO1xuXG4gICAgfVxuXG4gICAgXG5cbiAgICBwdWJsaWMgVGllcihkYXRlOiBzdHJpbmcsIGZsaWdodG51bWJlcjogc3RyaW5nLCBjaXR5OiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xuXG5cbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcIkFwaVVzZXJcIiwgdGhpcy5oZWFkZXJBcGl1c2VyKTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX2N1cnJlbmN5XCIsIHRoaXMuaGVhZGVyQ3VycmVuY3kpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfc2FsZXNvZmZpY2VcIiwgdGhpcy5zYWxlc09mZmljZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9odHRwLmdldCh0aGlzLmFjdGlvblVybGZvclBheEJ5RmxpZ2h0ICsgZGF0ZSArIFwiL1wiICsgZmxpZ2h0bnVtYmVyICsgXCIvXCIgKyBjaXR5ICsgXCIvcGFzc2VuZ2Vycy9hbGxcIiwgeyBoZWFkZXJzOiBoZWFkZXJzIH0pLm1hcChIYW5kbGVFcnJvckV4dHJhY3REYXRhLmV4dHJhY3REYXRhKS5jYXRjaChIYW5kbGVFcnJvckV4dHJhY3REYXRhLmhhbmRsZUVycm9ycyk7XG5cbiAgICB9XG5cbiAgICBcbiBcbiAgICBcblxuICAgIHB1YmxpYyBTdGF0dXMoZGF0ZTogc3RyaW5nLCBmbGlnaHRudW1iZXI6IHN0cmluZyxEZXBhdHVyZUNpdHk6c3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcblxuXG4gICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJBcGlVc2VyXCIsIHRoaXMuaGVhZGVyQXBpdXNlcik7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiaHR0cF9jdXJyZW5jeVwiLCB0aGlzLmhlYWRlckN1cnJlbmN5KTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX3NhbGVzb2ZmaWNlXCIsIHRoaXMuc2FsZXNPZmZpY2UpO1xuICAgICAgICByZXR1cm4gdGhpcy5faHR0cC5nZXQodGhpcy5hY3Rpb25Vcmxmb3JQYXhCeUZsaWdodCArIGRhdGUgKyBcIi9cIiArIGZsaWdodG51bWJlcitcIj9kZXBhcnR1cmU9XCIrRGVwYXR1cmVDaXR5LCB7IGhlYWRlcnM6IGhlYWRlcnMgfSkubWFwKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuZXh0cmFjdERhdGEpLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcblxuICAgIH1cbiAgICBcbiAgICBwdWJsaWMgU3RhdHVzQ29tcGVuc2F0aW9uKGRhdGU6IHN0cmluZywgZmxpZ2h0bnVtYmVyOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICBcbiAgICAgICAgXG4gICAgICAgICAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuICAgICAgICAgICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiQXBpVXNlclwiLCB0aGlzLmhlYWRlckFwaXVzZXIpO1xuICAgICAgICAgICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiaHR0cF9jdXJyZW5jeVwiLCB0aGlzLmhlYWRlckN1cnJlbmN5KTtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfc2FsZXNvZmZpY2VcIiwgdGhpcy5zYWxlc09mZmljZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAuZ2V0KHRoaXMuYWN0aW9uVXJsZm9yUGF4QnlGbGlnaHQgKyBkYXRlICsgXCIvXCIgKyBmbGlnaHRudW1iZXIsIHsgaGVhZGVyczogaGVhZGVycyB9KS5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSkuY2F0Y2goSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5oYW5kbGVFcnJvcnMpO1xuICAgICAgICBcbiAgICAgICAgICAgIH1cblxuICAgIFxuICAgIFxuICAgICAgICAgICAgcHVibGljIFVwZ3JhZGVPckRvd25HcmFkZUNoYW5nZXMocmVxdWVzdDogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcIkFwaVVzZXJcIiwgdGhpcy5oZWFkZXJBcGl1c2VyKTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX2N1cnJlbmN5XCIsIHRoaXMuaGVhZGVyQ3VycmVuY3kpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfc2FsZXNvZmZpY2VcIiwgdGhpcy5zYWxlc09mZmljZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9odHRwLnBvc3QodGhpcy5hY3Rpb25Vcmxmb3JDaGVja0luICsgXCJ1cGdyYWRlXCIsIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVxdWVzdCkpLCB7IGhlYWRlcnM6IGhlYWRlcnMgfSlcbiAgICAgICAgICAgIC5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSlcbiAgICB9XG5cbiAgICBwdWJsaWMgQm9va2luZ0NvdW50RGlzcGxheShkYXRlOiBzdHJpbmcsIGZsaWdodG51bWJlcjogc3RyaW5nLCBvcmlnaW46IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XG5cbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcIkFwaVVzZXJcIiwgdGhpcy5oZWFkZXJBcGl1c2VyKTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJodHRwX2N1cnJlbmN5XCIsIHRoaXMuaGVhZGVyQ3VycmVuY3kpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfc2FsZXNvZmZpY2VcIiwgdGhpcy5zYWxlc09mZmljZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9odHRwLmdldCh0aGlzLmFjdGlvblVybGZvcmJvb2tpbmdjb3VudCArIGRhdGUgKyBcIi9cIiArIGZsaWdodG51bWJlciArIFwiL1wiICsgb3JpZ2luICsgXCIvXCIgKyBcImJvb2tpbmdjb3VudFwiLCB7IGhlYWRlcnM6IGhlYWRlcnMgfSkubWFwKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuZXh0cmFjdERhdGEpLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcblxuICAgIH1cblxuICAgIHB1YmxpYyBHZXRCYWdUYWcocmVxdWVzdDogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcblxuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiQXBpVXNlclwiLCB0aGlzLmhlYWRlckFwaXVzZXIpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfY3VycmVuY3lcIiwgdGhpcy5oZWFkZXJDdXJyZW5jeSk7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiaHR0cF9zYWxlc29mZmljZVwiLCB0aGlzLnNhbGVzT2ZmaWNlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAucG9zdCh0aGlzLmFjdGlvblVybGZvckJhZ1RhZywgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyZXF1ZXN0KSksIHsgaGVhZGVyczogaGVhZGVycyB9KVxuICAgICAgICAgICAgLm1hcChIYW5kbGVFcnJvckV4dHJhY3REYXRhLmV4dHJhY3REYXRhKVxuICAgICAgICAgICAgLmNhdGNoKEhhbmRsZUVycm9yRXh0cmFjdERhdGEuaGFuZGxlRXJyb3JzKTtcbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSBleHRyYWN0RGF0YShyZXM6IFJlc3BvbnNlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgICAgIGlmIChyZXMudGV4dCgpLmluZGV4T2YoJ1NpdGVtaW5kZXIgLSBMb2dpbicpID4gLTEpIHtcbiAgICAgICAgICAgIHRocm93IFwiU2Vzc2lvblRpbWVvdXRcIlxuICAgICAgICB9XG4gICAgICAgIGxldCBib2R5ID0gcmVzLmpzb24oKTtcbiAgICAgICAgaWYgKGJvZHkuQmFkUmVxdWVzdCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGlmIChib2R5LkVycm9yTWVzc2FnZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyAoYm9keS5FcnJvck1lc3NhZ2UpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyAoYm9keS5nZW5lcmljTWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJvZHk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVFcnJvcihlcnJvcjogUmVzcG9uc2UpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJIYW5kbGVyIFJlYWR5XCIpO1xuICAgICAgICBjb25zdCBjb29raWVzOiBhbnkgPSBOU0hUVFBDb29raWVTdG9yYWdlLnNoYXJlZEhUVFBDb29raWVTdG9yYWdlLmNvb2tpZXM7XG4gICAgICAgIGlmICh0eXBlb2YgY29va2llcyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIC8vICAgICB0aGlzLk91dHB1dCA9IFwiTm8gQ29va2llKHMpIEF2YWlsYWJsZVwiO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb29raWVzLmNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb29raWU6IGFueSA9IGNvb2tpZXMub2JqZWN0QXRJbmRleChpKTtcbiAgICAgICAgICAgICAgICBpZiAoY29va2llLm5hbWUgPT0gXCJTTVNFU1NJT05cIilcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coY29va2llKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmcm9tIFNlcnZpY2UgXCIgKyBlcnJvcik7XG4gICAgICAgICAgICAvLyB2YXIgZXJyb3JNZXNzYWdlID0gZXJyb3IudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIC8vIGlmIChlcnJvck1lc3NhZ2UuaW5kZXhPZihcIlVucmVjb2duaXplZCB0b2tlbiAnPCdcIikgPT0gLTEpIHtcbiAgICAgICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhcImhpXCIpO1xuICAgICAgICAgICAgLy8gICAgIHJldHVybiBPYnNlcnZhYmxlLnRocm93KGVycm9yLmpzb24oKS5kYXRhIHx8ICdTZXJ2ZXIgZXJyb3InKTtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIC8vIGVsc2Uge1xuICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKFwiZWxzZVwiKTtcbiAgICAgICAgICAgIC8vICAgICByZXR1cm4gT2JzZXJ2YWJsZS50aHJvdyhlcnJvcik7XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE9ic2VydmFibGUudGhyb3coJ1VuYWJsZSB0byBDb25uZWN0LiBWZXJpZnkgTmV0d29yay4nKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3Iuc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBPYnNlcnZhYmxlLnRocm93KCdVbmFibGUgdG8gY29ubmVjdCB0byBzZXJ2ZXIuIE5ldHdvcmsgRXJyb3IuJyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yLnN0YXR1cyA9PSA0MDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZS50aHJvdygnVW5hYmxlIHRvIGdldCByZXNwb25zZS4gQmFkIFJlcXVlc3QuIFs0MDBdJyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yLnN0YXR1cyA9PSA0MDQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZS50aHJvdygnVW5hYmxlIHRvIGNvbm5lY3QgdG8gc2VydmVyLiBOZXR3b3JrIEVycm9yLiBbNDA0XScpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvci5zdGF0dXMgPT0gNTAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE9ic2VydmFibGUudGhyb3coJ0ludGVybmFsIFNlcnZlciBFcnJvciBbNTAwXS4nKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3Iuc3RhdHVzID09IDUwMikge1xuICAgICAgICAgICAgICAgIHJldHVybiBPYnNlcnZhYmxlLnRocm93KCd1bmFibGUgdG8gcmVjZWl2ZWQgYSB2YWxpZCByZXNwb25zZS5CYWQgR2F0ZVdheSBbNTAyXScpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZS50aHJvdyhlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgXCIgKyBlcnJvcik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkhhbmRsZXIgUmVhZHlcIik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImhpXCIpO1xuICAgICAgICAgICAgLy8gdGhpcy5kaXNwbGF5U3RhbmRhcmRwcm9kdWN0c0RpYWxvZygpOyAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIE9ic2VydmFibGUudGhyb3coY29va2llcyB8fCAnU2VydmVyIGVycm9yJyk7XG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgcHVibGljIEZRVFZVcGRhdGUocmVxdWVzdDogYW55LCBPcmRlcklkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiQXBpVXNlclwiLCB0aGlzLmhlYWRlckFwaXVzZXIpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcImh0dHBfY3VycmVuY3lcIiwgdGhpcy5oZWFkZXJDdXJyZW5jeSk7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiaHR0cF9zYWxlc29mZmljZVwiLCB0aGlzLnNhbGVzT2ZmaWNlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAucG9zdCh0aGlzLmFjdGlvblVybGZvclBheE9yZGVySUQgKyBPcmRlcklkICsgXCIvdHJhdmVsZXIvdXBkYXRlXCIsIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVxdWVzdCkpLCB7IGhlYWRlcnM6IGhlYWRlcnMgfSlcbiAgICAgICAgICAgIC5tYXAoSGFuZGxlRXJyb3JFeHRyYWN0RGF0YS5leHRyYWN0RGF0YSlcbiAgICAgICAgICAgIC5jYXRjaChIYW5kbGVFcnJvckV4dHJhY3REYXRhLmhhbmRsZUVycm9ycyk7XG4gICAgfVxuXG59XG5cbiJdfQ==