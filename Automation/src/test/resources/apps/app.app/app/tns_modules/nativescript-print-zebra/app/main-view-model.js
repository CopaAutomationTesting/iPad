"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var observable_1 = require("data/observable");
var nativescript_print_zebra_1 = require("nativescript-print-zebra");
var appSettings = require("application-settings");
var printId = "", binding = new observable_1.Observable();
function getPrinter() {
    if (appSettings.hasKey('printer')) {
        printId = appSettings.getString('printer', '');
        binding.set("printer", "Printer: " + printId);
        console.log(printId);
    }
}
var HelloWorldModel = (function (_super) {
    __extends(HelloWorldModel, _super);
    function HelloWorldModel() {
        var _this = _super.call(this) || this;
        _this.discovery = new nativescript_print_zebra_1.Discovery();
        _this.discovery.searchBluetooth().then(function (printers) {
            var count = printers.length;
            if (count === 0) {
                console.log("message", "Unable to find");
            }
            else if (count === 1) {
                appSettings.setString('printer', printers[0].address);
                getPrinter();
            }
        });
        _this.message = "Testing";
        new nativescript_print_zebra_1.Printer({ address: "XXQPJ162400947", language: 'CPCL' }).then(function (curPrinter, result) {
            var document = curPrinter.createDocument();
            document.image('~/sample.jpeg', 0);
            curPrinter.print(document).then(function () {
                curPrinter.disconnect();
            });
        });
        return _this;
    }
    return HelloWorldModel;
}(observable_1.Observable));
exports.HelloWorldModel = HelloWorldModel;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi12aWV3LW1vZGVsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibWFpbi12aWV3LW1vZGVsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsOENBQTZDO0FBQzdDLHFFQUE4RDtBQUU5RCxrREFBb0Q7QUFFcEQsSUFBSSxPQUFPLEdBQUcsRUFBRSxFQUFFLE9BQU8sR0FBRyxJQUFJLHVCQUFVLEVBQUUsQ0FBQztBQUM3QztJQUNDLEVBQUUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ25DLE9BQU8sR0FBRyxXQUFXLENBQUMsU0FBUyxDQUFDLFNBQVMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUMvQyxPQUFPLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxXQUFXLEdBQUcsT0FBTyxDQUFDLENBQUM7UUFDeEMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUU1QixDQUFDO0FBQ0YsQ0FBQztBQUNEO0lBQXFDLG1DQUFVO0lBSTlDO1FBQUEsWUFDQyxpQkFBTyxTQWtDUDtRQWpDQSxLQUFJLENBQUMsU0FBUyxHQUFHLElBQUksb0NBQVMsRUFBRSxDQUFDO1FBQ2pDLEtBQUksQ0FBQyxTQUFTLENBQUMsZUFBZSxFQUFFLENBQUMsSUFBSSxDQUFDLFVBQVUsUUFBUTtZQUM5QyxJQUFJLEtBQUssR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDO1lBTzVCLEVBQUUsQ0FBQyxDQUFDLEtBQUssS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNkLE9BQU8sQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLGdCQUFnQixDQUFDLENBQUM7WUFDN0MsQ0FBQztZQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFFckIsV0FBVyxDQUFDLFNBQVMsQ0FBQyxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDO2dCQUN0RCxVQUFVLEVBQUUsQ0FBQztZQUNqQixDQUFDO1FBUUwsQ0FBQyxDQUFDLENBQUM7UUFDVCxLQUFJLENBQUMsT0FBTyxHQUFHLFNBQVMsQ0FBQztRQUN6QixJQUFJLGtDQUFPLENBQUMsRUFBRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsVUFBVSxFQUFFLE1BQU07WUFDN0YsSUFBSSxRQUFRLEdBQUcsVUFBVSxDQUFDLGNBQWMsRUFBRSxDQUFDO1lBQzNDLFFBQVEsQ0FBQyxLQUFLLENBQUMsZUFBZSxFQUFDLENBQUMsQ0FBQyxDQUFDO1lBRWxDLFVBQVUsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDO2dCQUMvQixVQUFVLENBQUMsVUFBVSxFQUFFLENBQUM7WUFDekIsQ0FBQyxDQUFDLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQzs7SUFDSixDQUFDO0lBQ0Ysc0JBQUM7QUFBRCxDQUFDLEFBeENELENBQXFDLHVCQUFVLEdBd0M5QztBQXhDWSwwQ0FBZSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdkYXRhL29ic2VydmFibGUnO1xuaW1wb3J0IHsgRGlzY292ZXJ5LCBQcmludGVyIH0gZnJvbSAnbmF0aXZlc2NyaXB0LXByaW50LXplYnJhJztcbi8vIGltcG9ydCB7YXBwU2V0dGluZ3N9IGZyb20gJ2FwcGxpY2F0aW9uLXNldHRpbmdzJztcbmltcG9ydCAqIGFzIGFwcFNldHRpbmdzIGZyb20gJ2FwcGxpY2F0aW9uLXNldHRpbmdzJztcblxudmFyIHByaW50SWQgPSBcIlwiLCBiaW5kaW5nID0gbmV3IE9ic2VydmFibGUoKTtcbmZ1bmN0aW9uIGdldFByaW50ZXIoKSB7XG5cdGlmIChhcHBTZXR0aW5ncy5oYXNLZXkoJ3ByaW50ZXInKSkge1xuXHRcdHByaW50SWQgPSBhcHBTZXR0aW5ncy5nZXRTdHJpbmcoJ3ByaW50ZXInLCAnJyk7XG5cdFx0YmluZGluZy5zZXQoXCJwcmludGVyXCIsIFwiUHJpbnRlcjogXCIgKyBwcmludElkKTtcbiAgICAgICAgY29uc29sZS5sb2cocHJpbnRJZCk7IC8vIFByaW50cyBvdXQgYSBsaXN0IG9mIGRldmljZXMgZm91bmQhXG5cdFx0XG5cdH1cbn1cbmV4cG9ydCBjbGFzcyBIZWxsb1dvcmxkTW9kZWwgZXh0ZW5kcyBPYnNlcnZhYmxlIHtcblx0cHVibGljIG1lc3NhZ2U6IHN0cmluZztcblx0cHJpdmF0ZSBkaXNjb3Zlcnk6IERpc2NvdmVyeTtcblxuXHRjb25zdHJ1Y3RvcigpIHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMuZGlzY292ZXJ5ID0gbmV3IERpc2NvdmVyeSgpO1xuXHRcdHRoaXMuZGlzY292ZXJ5LnNlYXJjaEJsdWV0b290aCgpLnRoZW4oZnVuY3Rpb24gKHByaW50ZXJzKSB7XG4gICAgICAgICAgICB2YXIgY291bnQgPSBwcmludGVycy5sZW5ndGg7XG4gICAgICAgICAgICAvLyBmb3IgKHZhciBpPTA7aTxjb3VudDtpKyspIHtcbiAgICAgICAgICAgIC8vIFx0dmFyIHByaW50ZXIgPSBwcmludGVycy5nZXQoaSk7XG4gICAgICAgICAgICAvLyBcdHRoaXMucGRhdGEucHVzaCh7bmFtZTogcHJpbnRlci5mcmllbmRseU5hbWUsIGFkZHJlc3M6IHByaW50ZXIuYWRkcmVzc30pO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgLy8gY29uc29sZS5kdW1wKHRoaXMucGRhdGEpOyAvLyBQcmludHMgb3V0IGEgbGlzdCBvZiBkZXZpY2VzIGZvdW5kIVxuICAgICAgICAgICAgLy8gfSk7XG4gICAgICAgICAgICBpZiAoY291bnQgPT09IDApIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm1lc3NhZ2VcIiwgXCJVbmFibGUgdG8gZmluZFwiKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY291bnQgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAvLyBXZSBmb3VuZCBhIHZhbGlkIHByaW50ZXJcbiAgICAgICAgICAgICAgICBhcHBTZXR0aW5ncy5zZXRTdHJpbmcoJ3ByaW50ZXInLCBwcmludGVyc1swXS5hZGRyZXNzKTtcbiAgICAgICAgICAgICAgICBnZXRQcmludGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBlbHNlIHtcbiAgICAgICAgICAgIC8vICAgICAvLyBXZSBmb3VuZCBzb21lIGRldmljZXM7IHNob3cgdGhlbSB0byBhbGxvdyBpdCB0byBiZSBwaWNrZWRcbiAgICAgICAgICAgIC8vICAgICBwYWdlLnNob3dNb2RhbCgnZGlzY292ZXJ5TGlzdCcsIHsgcHJpbnRlcnM6IHByaW50ZXJzIH0sIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgYXBwU2V0dGluZ3Muc2V0U3RyaW5nKCdwcmludGVyJywgcmVzdWx0LnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgZ2V0UHJpbnRlcigpO1xuICAgICAgICAgICAgLy8gICAgICAgICB9XG4gICAgICAgIH0pO1xuXHRcdHRoaXMubWVzc2FnZSA9IFwiVGVzdGluZ1wiO1xuXHRcdG5ldyBQcmludGVyKHsgYWRkcmVzczogXCJYWFFQSjE2MjQwMDk0N1wiLCBsYW5ndWFnZTogJ0NQQ0wnIH0pLnRoZW4oZnVuY3Rpb24gKGN1clByaW50ZXIsIHJlc3VsdCkge1xuXHRcdFx0dmFyIGRvY3VtZW50ID0gY3VyUHJpbnRlci5jcmVhdGVEb2N1bWVudCgpO1xuXHRcdFx0ZG9jdW1lbnQuaW1hZ2UoJ34vc2FtcGxlLmpwZWcnLDApO1xuICAgICAgICAgICAgLy8gZG9jdW1lbnQudGV4dCgnfi9Cb2FyZGluZ1Bhc3NBVE9fMi5wZGYnLDApO1xuXHRcdFx0Y3VyUHJpbnRlci5wcmludChkb2N1bWVudCkudGhlbihmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdGN1clByaW50ZXIuZGlzY29ubmVjdCgpO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cbn1cbiJdfQ==